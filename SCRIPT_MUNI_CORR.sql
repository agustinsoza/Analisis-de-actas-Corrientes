--CRACION BASE DE DATOS

DROP DATABASE MUNI_CORRIENTES;
CREATE DATABASE MUNI_CORRIENTES;
USE MUNI_CORRIENTES;

--CREACION PROCEDIMIENTOS

CREATE PROCEDURE LlenarCalendario
AS
BEGIN
    DECLARE @FechaInicio DATE = '2018-01-01';
    DECLARE @FechaFin DATE = '2023-12-31';

    WHILE @FechaInicio <= @FechaFin
    BEGIN
        INSERT INTO CALENDARIO (FECHA, AÑO, MES, DIA, NOMBRE_DIA, NOMBRE_MES)
        VALUES (
            @FechaInicio,
			YEAR(@FechaInicio),
			MONTH(@FechaInicio),
			DAY(@FechaInicio),
            DATENAME(WEEKDAY, @FechaInicio),
            DATENAME(MONTH, @FechaInicio)
        );

        SET @FechaInicio = DATEADD(DAY, 1, @FechaInicio);
    END;
END;

CREATE TABLE CALENDARIO (
	FECHA DATE,
	AÑO INT,
	MES INT,
	DIA INT,
	NOMBRE_DIA VARCHAR(25),
	NOMBRE_MES VARCHAR(25)
);

EXEC LlenarCalendario;

CREATE FUNCTION RemoverNoNumericos(@cadena NVARCHAR(MAX))
RETURNS NVARCHAR(MAX)
AS
BEGIN
    DECLARE @resultado NVARCHAR(MAX) = '';
    DECLARE @caracter NVARCHAR(1);
    DECLARE @posicion INT = 1;

    WHILE @posicion <= LEN(@cadena)
    BEGIN
        SET @caracter = SUBSTRING(@cadena, @posicion, 1);
        IF @caracter LIKE '[0-9]'
            SET @resultado = @resultado + @caracter;
        SET @posicion = @posicion + 1;
    END

    RETURN @resultado;
END;


-- CREACION DE TABLAS AUXILIARES


CREATE TABLE AUX_ACTAS (
	FECHA VARCHAR(100),
	TIPO_VEHICULO VARCHAR(100),
	LUGAR VARCHAR(150)
);

BULK INSERT AUX_ACTAS
FROM 'C:\\Users\\Usuario\\Documents\\DATA ANALYTICS\\ANALISIS MUNI CORRIENTES\\ARCHIVOS\\TRANSPORTE.xlsm - Actas de Infraccion por Vehicul.csv'
WITH (
    FIELDTERMINATOR = ',',
    ROWTERMINATOR = '\n',
    FIRSTROW = 1, -- Si la primera fila del archivo CSV es un encabezado
    TABLOCK
);

--LIMPIEZA Y TRANSFORMACION DE TABLA AUX 

UPDATE AUX_ACTAS SET FECHA = TRIM(FECHA), TIPO_VEHICULO = TRIM(TIPO_VEHICULO), LUGAR = TRIM(LUGAR);
UPDATE AUX_ACTAS SET FECHA = CONVERT(DATE, FECHA, 103);
UPDATE AUX_ACTAS SET FECHA = UPPER(FECHA), TIPO_VEHICULO = UPPER(TIPO_VEHICULO), LUGAR = UPPER(LUGAR);
UPDATE AUX_ACTAS SET TIPO_VEHICULO = 'REMISES' WHERE TIPO_VEHICULO = 'REMISSES';

ALTER TABLE AUX_ACTAS ADD CALLE VARCHAR(100);
ALTER TABLE AUX_ACTAS ADD ALTURA VARCHAR(5);

UPDATE AUX_ACTAS SET ALTURA = RIGHT(LUGAR, 4);
UPDATE AUX_ACTAS SET ALTURA = TRIM(ALTURA);

UPDATE AUX_ACTAS SET CALLE = 'CATAMARCA' WHERE	LUGAR LIKE ('CAT%') OR
												LUGAR LIKE ('CTAM%') OR
												LUGAR LIKE ('CAMAR%');

UPDATE AUX_ACTAS SET CALLE = 'H. YRIGOYEN' WHERE	LUGAR LIKE ('"H.%') OR
													LUGAR LIKE ('"H,%') OR
													LUGAR LIKE ('H %') OR
													LUGAR LIKE ('H.%') OR
													LUGAR LIKE ('HIP%') OR
													LUGAR LIKE ('HIR%') OR
													LUGAR LIKE ('I Y%') OR
													LUGAR LIKE ('IPO%') OR
													LUGAR LIKE ('IRI%') OR
													LUGAR LIKE ('YRI%') OR
													LUGAR LIKE ('YRY%');

UPDATE AUX_ACTAS SET CALLE = 'BELGRANO' WHERE	LUGAR LIKE ('BEL%') OR
												LUGAR LIKE ('PLAY+¦N INTERNO DE LA SUBSECRETARIA DE TRANSPORTE.%') OR
												LUGAR LIKE ('PLAYON DE TRANSPORTE%') OR
												LUGAR LIKE ('PLAYON DEL PISO%');

UPDATE AUX_ACTAS SET CALLE = 'LOS GIRASOLES' WHERE	LUGAR LIKE ('LOS GI%');

UPDATE AUX_ACTAS SET CALLE = 'SALTA' WHERE	LUGAR LIKE ('AV SALTA%') OR
											LUGAR LIKE ('SAL%');

UPDATE AUX_ACTAS SET CALLE = 'SAN MARTIN' WHERE	LUGAR LIKE ('S. MAR%') OR
												LUGAR LIKE ('"S. MAR%') OR
												LUGAR LIKE ('SAN MAR%') OR
												LUGAR LIKE ('SAN MAER%') OR
												LUGAR LIKE ('SAN MAT%') OR
												LUGAR LIKE ('SAN MER%') OR
												LUGAR LIKE ('SANM MAR%');

UPDATE AUX_ACTAS SET CALLE = 'AV. CHACABUCO' WHERE	LUGAR LIKE ('"AV, CHA%') OR
													LUGAR LIKE ('AV CHA%') OR
													LUGAR LIKE ('AV. CHA%') OR
													LUGAR LIKE ('AV.CHA%') OR
													LUGAR LIKE ('CHACA%') OR
													LUGAR LIKE ('CAHCA%') OR
													LUGAR LIKE ('CHACU%') OR
													LUGAR LIKE ('AV.CHA%');

UPDATE AUX_ACTAS SET CALLE = 'ESPAÑA' WHERE	LUGAR LIKE ('"AV, ESPA%') OR
											LUGAR LIKE ('AV. ESPE+%') OR
											LUGAR LIKE ('AV.ESPA+%') OR
											LUGAR LIKE ('AV ESPA%') OR
											LUGAR LIKE ('AV. ESPA%') OR
											LUGAR LIKE ('EAPA+ÆA 400%') OR
											LUGAR LIKE ('ESOA+ÆA 715%') OR
											LUGAR LIKE ('ESPE+ÆA AL 1365%') OR
											LUGAR LIKE ('SPA+ÆA 989%') OR
											LUGAR LIKE ('STA. FE AL 800%') OR
											LUGAR LIKE ('ESPA%');

UPDATE AUX_ACTAS SET CALLE = 'AV. FERRE' WHERE	LUGAR LIKE ('"AV, FERR%') OR
												LUGAR LIKE ('AV FERR%') OR
												LUGAR LIKE ('AV. FERR%') OR
												LUGAR LIKE ('AV. PEDRO FERRE%') OR
												LUGAR LIKE ('AVENIDA FERRE%') OR
												LUGAR LIKE ('FERRE%');

UPDATE AUX_ACTAS SET CALLE = 'RAFAELA' WHERE	LUGAR LIKE ('"AV, RAFA%') OR
												LUGAR LIKE ('AV. RAFA%') OR
												LUGAR LIKE ('PAISANDU Y RAFAELA%') OR
												LUGAR LIKE ('AV. PAISANDU Y RAFAELA%') OR
												LUGAR LIKE ('RAFA%');

UPDATE AUX_ACTAS SET CALLE = 'AV. JUAN TORRES DE VERA Y ARAGON' WHERE	LUGAR LIKE ('"AV, VERA%') OR
																		LUGAR LIKE ('A VERA%') OR
																		LUGAR LIKE ('A. VERA%') OR
																		LUGAR LIKE ('AV VERA%') OR
																		LUGAR LIKE ('AV. J DE VERA%') OR
																		LUGAR LIKE ('AV. J TORRES DE VERA%') OR
																		LUGAR LIKE ('AV. J. TORRE DE VERA%') OR
																		LUGAR LIKE ('AV. J. VERA%') OR
																		LUGAR LIKE ('AV. J.TORRES DE VERA%') OR
																		LUGAR LIKE ('AV. JUAN DE VERA 1426%') OR
																		LUGAR LIKE ('AV. JUAN T. DE VERA 1200%') OR
																		LUGAR LIKE ('AV. TORRES DE VERA%') OR
																		LUGAR LIKE ('AV. VERA%') OR
																		LUGAR LIKE ('AV.TORRES VERA%') OR
																		LUGAR LIKE ('AV.VERA%') OR
																		LUGAR LIKE ('AVENIDA TORRE%') OR
																		LUGAR LIKE ('AVENIDA TORRES%') OR
																		LUGAR LIKE ('AVENIDA VERA%') OR
																		LUGAR LIKE ('CORREDOR VERA%') OR
																		LUGAR LIKE ('COSTANERA J.T%') OR
																		LUGAR LIKE ('J DE VERA%') OR
																		LUGAR LIKE ('J T. VERA%') OR
																		LUGAR LIKE ('J VERA%') OR
																		LUGAR LIKE ('J. T%') OR
																		LUGAR LIKE ('J. VERA%') OR
																		LUGAR LIKE ('J.T%') OR
																		LUGAR LIKE ('J.VERA%') OR
																		LUGAR LIKE ('JJ DE VERA%') OR
																		LUGAR LIKE ('JUAN DE VERA%') OR
																		LUGAR LIKE ('JUAN T. DE VERA%') OR
																		LUGAR LIKE ('JUAN TORES DE VERA%') OR
																		LUGAR LIKE ('JUAN TORRE VERA%') OR
																		LUGAR LIKE ('JUAN TORRES DE VERA%') OR
																		LUGAR LIKE ('TORRE DE VERA%') OR
																		LUGAR LIKE ('TORRES DE VERA%') OR
																		LUGAR LIKE ('JUAN TORRE 1200%') OR
																		LUGAR LIKE ('VERA%');

UPDATE AUX_ACTAS SET CALLE = 'A. C. FERNANDEZ' WHERE	LUGAR LIKE ('"AV. DR, CORREA AL 1700"%') OR
														LUGAR LIKE ('A. CORREA FERNANDEZ Y SARMIENTO%') OR
														LUGAR LIKE ('AV CORREA FERNANDEZ Y SARMIENTO%') OR
														LUGAR LIKE ('AV FERNANDEZ Y CORREA%') OR
														LUGAR LIKE ('AV.C. FERNANDEZ 1700%') OR
														LUGAR LIKE ('AVIADOR FERNANDEZ 2100%') OR
														LUGAR LIKE ('AVIADOR FERNANDEZ Y GUTEMBERG%') OR
														LUGAR LIKE ('FERNANDEZ Y SARMIENTO%') OR
														LUGAR LIKE ('SARMIENTO Y CORREA FERNANDEZ%') OR
														LUGAR LIKE ('AVIADOR GOMEZ Y SARMIENTO%') OR
														LUGAR LIKE ('AV. AVIADOR CORREA AL 1700%') OR
														LUGAR LIKE ('AV. CORREA FERNANDEZ%') OR
														LUGAR LIKE ('AV. CORREA Y SARMIENTO%') OR
														LUGAR LIKE ('AVENIDA CORREA Y SARMIENTO%') OR
														LUGAR LIKE ('AVIADOR CORREA Y SARMIENTO%') OR
														LUGAR LIKE ('CORREA FERNANDEZ 1800%') OR
														LUGAR LIKE ('CORREA FERNANDEZ 400%') OR
														LUGAR LIKE ('GDOR CORREA Y SARMIENTO%') OR
														LUGAR LIKE ('A FERNANDEZ Y SARMIENTO%') OR
														LUGAR LIKE ('A. C.%') OR
														LUGAR LIKE ('COREA FERN+ÍNDEZ AL 400%') OR
														LUGAR LIKE ('A. FERNANDEZ%');

UPDATE AUX_ACTAS SET CALLE = 'DR. R. CARRILLO' WHERE	LUGAR LIKE ('"DR, RICARDO CARRILLO AL 600"%') OR
														LUGAR LIKE ('CARRILLO AL 500%') OR
														LUGAR LIKE ('DR. CARRILLO AL 600%') OR
														LUGAR LIKE ('DR. CARRILLO Y B. DE LA VEGA%') OR
														LUGAR LIKE ('DR. CARVALLO AL 500%') OR
														LUGAR LIKE ('DR.RAMON CARRILLO AL 500.%');

UPDATE AUX_ACTAS SET CALLE = 'PLACIDO MARTINEZ' WHERE	LUGAR LIKE ('P. M%') OR
														LUGAR LIKE ('P, M%') OR
														LUGAR LIKE ('"P, M%') OR
														LUGAR LIKE ('P.MAR%') OR
														LUGAR LIKE ('P/MAR%') OR
														LUGAR LIKE ('PALACIDO%') OR
														LUGAR LIKE ('PL+%') OR
														LUGAR LIKE ('C. MART%') OR
														LUGAR LIKE ('PLACIDO%');

UPDATE AUX_ACTAS SET CALLE = 'RENACIMIENTO' WHERE	LUGAR LIKE ('"RENACI,IENTO Y LAURELES"%') OR
													LUGAR LIKE ('RENACIMIENTO Y CALLE 506%');

UPDATE AUX_ACTAS SET CALLE = 'SANCHEZ DE BUSTAMANTE' WHERE	LUGAR LIKE ('"SANCHEZ DE BUZTAM,ANTE AL 2100"%') OR
															LUGAR LIKE ('AV SANCHEZ DE BUSTAMANTE AL 1900%') OR
															LUGAR LIKE ('SANCHES DE BUSTAMANTE 2200%') OR
															LUGAR LIKE ('SANCHEZ BUSTAMANTE Y CAZADORES%') OR
															LUGAR LIKE ('S/BUSTAMANTE 4008%') OR
															LUGAR LIKE ('SANVHEZ DE BUZTAMANTE Y AV.CAZADOREZ CORRENTINOS%') OR
															LUGAR LIKE ('SANCHEZ%');

UPDATE AUX_ACTAS SET CALLE = 'ÑAEMBE' WHERE	LUGAR LIKE ('+ÆAEMBE 3000%');

UPDATE AUX_ACTAS SET CALLE = '11 DE MAYO' WHERE	LUGAR LIKE ('11 DE MAYO AL 800%') OR
												LUGAR LIKE ('11 DE MAYO Y ARMENIA%');

UPDATE AUX_ACTAS SET CALLE = '20 DE MAYO' WHERE	LUGAR LIKE ('20 DE MAYO AL 700%') OR
												LUGAR LIKE ('20 DE MAYO AL 700.%');

UPDATE AUX_ACTAS SET CALLE = '25 DE MAYO' WHERE	LUGAR LIKE ('25 %') OR
												LUGAR LIKE ('250%') OR
												LUGAR LIKE ('MAYO%');

UPDATE AUX_ACTAS SET CALLE = 'AV. 3 DE ABRIL' WHERE	LUGAR LIKE ('3 DE%') OR
													LUGAR LIKE ('3 ABR%') OR
													LUGAR LIKE ('AV. TRES DE ABRIL 383%') OR
													LUGAR LIKE ('3DE%') OR
													LUGAR LIKE ('AV 3%') OR
													LUGAR LIKE ('AV. 3%') OR
													LUGAR LIKE ('AV. DE ABRIL 857%') OR
													LUGAR LIKE ('GUASTAVINO Y 3 DE ABRIL%') OR
													LUGAR LIKE ('AV.3%');

UPDATE AUX_ACTAS SET CALLE = '9 DE JULIO' WHERE	LUGAR LIKE ('%9 DE%') OR
												LUGAR LIKE ('9  DE%') OR
												LUGAR LIKE ('9 DE%') OR
												LUGAR LIKE ('%9DE%') OR
												LUGAR LIKE ('%9 JU%') OR
												LUGAR LIKE ('JULIO %') OR
												LUGAR LIKE ('CALLE 9 DE%');

UPDATE AUX_ACTAS SET CALLE = 'PJE. AGUSTIN GONZALEZ' WHERE	LUGAR LIKE ('A GON%') OR
															LUGAR LIKE ('A. GON%') OR
															LUGAR LIKE ('A.GON%') OR
															LUGAR LIKE ('A/GON%') OR
															LUGAR LIKE ('AG. GON%') OR
															LUGAR LIKE ('AGUST%') OR
															LUGAR LIKE ('PASAJE AGU%') OR
															LUGAR LIKE ('PJE AG%') OR
															LUGAR LIKE ('PJE. A%');

UPDATE AUX_ACTAS SET CALLE = 'AV. ALBERDI' WHERE	LUGAR LIKE ('ALBERDI 2138%') OR
													LUGAR LIKE ('ABERDI%');

UPDATE AUX_ACTAS SET CALLE = 'AV. RAUL ALFONSIN' WHERE	LUGAR LIKE ('ALF%') OR
														LUGAR LIKE ('AV ALF%') OR
														LUGAR LIKE ('AV RAUL%') OR
														LUGAR LIKE ('AV. ALF%') OR
														LUGAR LIKE ('AV. R.%') OR
														LUGAR LIKE ('AV. RA+%') OR
														LUGAR LIKE ('AV. RAUL%') OR
														LUGAR LIKE ('AV.RAUL%') OR
														LUGAR LIKE ('AVENIDA RAUL%') OR
														LUGAR LIKE ('R. ALF%') OR
														LUGAR LIKE ('RAUL ALF%') OR
														LUGAR LIKE ('HOSPITAL LLA%') OR
														LUGAR LIKE ('PTE ALF%');

UPDATE AUX_ACTAS SET CALLE = 'ACCESO A PERICHON' WHERE	LUGAR LIKE ('%ACCE%') OR
														LUGAR LIKE ('%ACCC%') OR
														LUGAR LIKE ('%RUTA 12 Y PRICHON%');

UPDATE AUX_ACTAS SET CALLE = 'ACONCAGUA' WHERE	LUGAR LIKE ('ACON%') OR
												LUGAR LIKE ('IBERA  Y SANTA CATALINA') OR
												LUGAR LIKE ('STA CATALINA  Y ACONCAGUA') OR
												LUGAR LIKE ('SANTA CATALINA Y ACONCAGUA');

UPDATE AUX_ACTAS SET CALLE = 'AEROPUERTO' WHERE	LUGAR LIKE ('%AEROPUERTO%') OR
												LUGAR LIKE ('%COLECTORA AEROPUERTO%');

UPDATE AUX_ACTAS SET CALLE = 'C. J. M. AGUIRRE' WHERE	LUGAR LIKE ('AGUIRRE%') OR
														LUGAR LIKE ('AGURRE%') OR
														LUGAR LIKE ('JOSE M. A%') OR
														LUGAR LIKE ('AV. LARRATEA Y AGUIRRE.%') OR
														LUGAR LIKE ('LARRATEA Y AGUIRRE%');

UPDATE AUX_ACTAS SET CALLE = 'ALTA GRACIA' WHERE	LUGAR LIKE ('ALTA%') OR
													LUGAR LIKE ('AV. ALTA%') OR
													LUGAR LIKE ('AV.ALTA%');

UPDATE AUX_ACTAS SET CALLE = 'SAN JUAN' WHERE	LUGAR LIKE ('AN JUAN%') OR
												LUGAR LIKE ('DAN JUAN%') OR
												LUGAR LIKE ('SAN JUAN%') OR
												LUGAR LIKE ('SAM JUAN%') OR
												LUGAR LIKE ('SAN JAU%') OR
												LUGAR LIKE ('SAN JUA%') OR
												LUGAR LIKE ('SAN AL 700%') OR
												LUGAR LIKE ('SANJUAN%');

UPDATE AUX_ACTAS SET CALLE = 'AV. ARGENTINA' WHERE	LUGAR LIKE ('ARGEN%');

UPDATE AUX_ACTAS SET CALLE = 'AV. ARMENIA' WHERE	LUGAR LIKE ('ARME%') OR
													LUGAR LIKE ('AV ARME%') OR
													LUGAR LIKE ('AV. ARME%');

UPDATE AUX_ACTAS SET CALLE = 'AV. ARTIGAS' WHERE	LUGAR LIKE ('ARTI%') OR
													LUGAR LIKE ('DARSENA DEL PEDIATRICO%') OR
													LUGAR LIKE ('PLAYON DEL PEDIATRICO%') OR
													LUGAR LIKE ('PLAYON HOSPITAL PEDI+ÍTRICO%') OR
													LUGAR LIKE ('AV. ARTI%');

UPDATE AUX_ACTAS SET CALLE = 'NUESTRA SEÑORA DE LA ASUNCION' WHERE	LUGAR LIKE ('ASUN%') OR
																	LUGAR LIKE ('N. S. DE LA%') OR
																	LUGAR LIKE ('NTRA SRA%') OR
																	LUGAR LIKE ('N. SRA DE LA ASUSNCION 2600%') OR
																	LUGAR LIKE ('CURUZ+Ü CUAT+Ì Y NUESTRA SE+ÆORA DE LA ASUNCI+ÔN%') OR
																	LUGAR LIKE ('NUESTRA SE+%');

UPDATE AUX_ACTAS SET CALLE = 'AV. MAIPÚ' WHERE	LUGAR LIKE ('AV MAY%') OR
												LUGAR LIKE ('AV. MAI%') OR
												LUGAR LIKE ('AV.-MAI%') OR
												LUGAR LIKE ('AV. MAIPU%') OR
												LUGAR LIKE ('AV.- MAIPU 2400%') OR
												LUGAR LIKE ('AV. MAY%') OR
												LUGAR LIKE ('MAYP%') OR
												LUGAR LIKE ('AV .MAI%') OR
												LUGAR LIKE ('AV MAI%') OR
												LUGAR LIKE ('AV. MAI%') OR
												LUGAR LIKE ('AV.-MAI%') OR
												LUGAR LIKE ('AV.MAI%') OR
												LUGAR LIKE ('AVENIDA MAI%') OR
												LUGAR LIKE ('MAI%') OR
												LUGAR LIKE ('GUAIQUIRARO Y MAIPU%') OR
												LUGAR LIKE ('SV MAIPU%');

UPDATE AUX_ACTAS SET CALLE = 'AV. CAZADORES CORRENTINOS' WHERE	LUGAR LIKE ('AV CASA%') OR
																LUGAR LIKE ('AV CAZA%') OR
																LUGAR LIKE ('AV. CAZA%') OR
																LUGAR LIKE ('AVENIDA CAZA%') OR
																LUGAR LIKE ('AV.CAZADORES%') OR
																LUGAR LIKE ('CASA%') OR
																LUGAR LIKE ('C. CORRENTINO%') OR
																LUGAR LIKE ('CAZA%');

UPDATE AUX_ACTAS SET CALLE = 'AV. CENTENARIO' WHERE	LUGAR LIKE ('AV CENTE%') OR
													LUGAR LIKE ('AV. CENTE%') OR
													LUGAR LIKE ('CENTA%') OR
													LUGAR LIKE ('CENTE%');

UPDATE AUX_ACTAS SET CALLE = 'COSQUIN' WHERE	LUGAR LIKE ('AV COSQ%') OR
												LUGAR LIKE ('AV. COSQ%') OR
												LUGAR LIKE ('COSQ%');

UPDATE AUX_ACTAS SET CALLE = 'AV. COSTANERA GRAL. SAN MARTIN' WHERE	LUGAR LIKE ('AV COST%') OR
																	LUGAR LIKE ('AV. SAN M%') OR
																	LUGAR LIKE ('AV. SN M%') OR
																	LUGAR LIKE ('AV- COST%') OR
																	LUGAR LIKE ('AV. GRAL. SAN MARTIN%') OR
																	LUGAR LIKE ('AV-COST%') OR
																	LUGAR LIKE ('AV. COST%') OR
																	LUGAR LIKE ('AVEIDA COST%') OR
																	LUGAR LIKE ('AVENIDA COSTANERA%') OR
																	LUGAR LIKE ('COST%') OR
																	LUGAR LIKE ('AV COST%') OR
																	LUGAR LIKE ('AV- COST%') OR
																	LUGAR LIKE ('AV-COST%') OR
																	LUGAR LIKE ('AV. COST%') OR
																	LUGAR LIKE ('AVEIDA COST%') OR
																	LUGAR LIKE ('COST%') OR
																	LUGAR LIKE ('COATA%') OR
																	LUGAR LIKE ('D+ÍRSENA%') OR
																	LUGAR LIKE ('DARCENA DEL PUERTO%') OR
																	LUGAR LIKE ('DARSENA DEL PUERTO%') OR
																	LUGAR LIKE ('P. DEL PUERTO%') OR
																	LUGAR LIKE ('P.DEL PUERTO%') OR
																	LUGAR LIKE ('P+%') OR
																	LUGAR LIKE ('PLAY+¦N DEL PUERTO%') OR
																	LUGAR LIKE ('PLAY+ÔN DEL PUERTO%') OR
																	LUGAR LIKE ('PLAY+ÔN PUERTO%') OR
																	LUGAR LIKE ('PLAYA DEL PUERTO%') OR
																	LUGAR LIKE ('PLAYON  PUERTO%') OR
																	LUGAR LIKE ('PLAYON DE PUERTO%') OR
																	LUGAR LIKE ('PLAYON DEL P+ÖERTO%') OR
																	LUGAR LIKE ('PLAYON DEL PUERTO%') OR
																	LUGAR LIKE ('PLAYON PUERTO%') OR
																	LUGAR LIKE ('PLAYON PUERTO-%') OR
																	LUGAR LIKE ('PLAYON PUERTO LOCAL%') OR
																	LUGAR LIKE ('PUERTO%') OR
																	LUGAR LIKE ('PLAY%') OR
																	LUGAR LIKE ('AV. GENERAL SAN MARTIN AL 700%');

UPDATE AUX_ACTAS SET CALLE = 'AV. EL MAESTRO' WHERE	LUGAR LIKE ('AV EL M%') OR
													LUGAR LIKE ('AV. EL M%') OR
													LUGAR LIKE ('EL MAE%');

UPDATE AUX_ACTAS SET CALLE = 'AV. GDOR. RUIZ' WHERE	LUGAR LIKE ('AV GDOR R%') OR
													LUGAR LIKE ('A. G. R%') OR
													LUGAR LIKE ('FGOB%') OR
													LUGAR LIKE ('AV. G. R%') OR
													LUGAR LIKE ('G. RU%') OR
													LUGAR LIKE ('GOB R%') OR
													LUGAR LIKE ('GOB. R%') OR
													LUGAR LIKE ('GR. R%') OR
													LUGAR LIKE ('AV. GDOR R%') OR
													LUGAR LIKE ('AV. GDOR. R%') OR
													LUGAR LIKE ('AV. GOBERNADOR R%') OR
													LUGAR LIKE ('GDOR R%') OR
													LUGAR LIKE ('GDOR. R%') OR
													LUGAR LIKE ('GDOR.R%') OR
													LUGAR LIKE ('GOBERNADOR R%') OR
													LUGAR LIKE ('GOBERNBADOR R%');

UPDATE AUX_ACTAS SET CALLE = 'AV. INDEPENDENCIA' WHERE	LUGAR LIKE ('AV INDE%') OR
														LUGAR LIKE ('AV. INDE%') OR
														LUGAR LIKE ('AV.INDE%') OR
														LUGAR LIKE ('AVENIDA IND%') OR
														LUGAR LIKE ('INDEP%');

UPDATE AUX_ACTAS SET CALLE = 'AV. NARCISO LAPRIDA' WHERE	LUGAR LIKE ('AV LA PR%') OR
															LUGAR LIKE ('AV LAPR%') OR
															LUGAR LIKE ('AV. LA PR%') OR
															LUGAR LIKE ('AV. LAPR%') OR
															LUGAR LIKE ('AV.LA PR%') OR
															LUGAR LIKE ('AVENIDA LA PRI%') OR
															LUGAR LIKE ('LA PRID%') OR
															LUGAR LIKE ('OLIVOS Y LAPRIDA%') OR
															LUGAR LIKE ('RIO LUJAN 581%') OR
															LUGAR LIKE ('LAPRID%');

UPDATE AUX_ACTAS SET CALLE = 'AV. LIBERTAD' WHERE	LUGAR LIKE ('AV LIBE%') OR
													LUGAR LIKE ('AV. LIBE%') OR
													LUGAR LIKE ('LIBE%');

UPDATE AUX_ACTAS SET CALLE = 'MEDRANO' WHERE	LUGAR LIKE ('AV MEDR%') OR
												LUGAR LIKE ('AV. MEDR%') OR
												LUGAR LIKE ('CANGALLO Y MEDRANO%') OR
												LUGAR LIKE ('SAN FRANCISCO DE ASIS Y MEDRANO%') OR
												LUGAR LIKE ('MEDR%');

UPDATE AUX_ACTAS SET CALLE = 'AV. PATAGONIA' WHERE	LUGAR LIKE ('AV PATA%') OR
													LUGAR LIKE ('AV. PATA%') OR
													LUGAR LIKE ('PATAGONIA Y SARMIENTO%') OR
													LUGAR LIKE ('AV ESTRADA Y PATAGONIA%') OR
													LUGAR LIKE ('PATAGONIA Y PAYSANDU%') OR
													LUGAR LIKE ('PATAGONIA Y AV DEL MAESTRO%') OR
													LUGAR LIKE ('PATAGONIA Y AV ESTRADA%') OR
													LUGAR LIKE ('PATAGONIA Y ESTRADA%') OR
													LUGAR LIKE ('PATAGONIAY ESTRADA%') OR
													LUGAR LIKE ('AV. ESTRADA Y EL MAESTRO%') OR
													LUGAR LIKE ('AV. ESTRADA Y PATAGONIA%') OR
													LUGAR LIKE ('AV. J. M. ESTRADA Y PATAGONIA%') OR
													LUGAR LIKE ('ESTRADA Y PATAGONIA%') OR
													LUGAR LIKE ('J M ESTRADA Y PATAGONIA%') OR
													LUGAR LIKE ('PATAGO%') OR
													LUGAR LIKE ('PATAGONIA Y PAISANDU%');

UPDATE AUX_ACTAS SET CALLE = 'GREGORIO POMAR' WHERE	LUGAR LIKE ('AV POM%') OR
													LUGAR LIKE ('AV. POM%') OR
													LUGAR LIKE ('AV.POM%') OR
													LUGAR LIKE ('POM%');

UPDATE AUX_ACTAS SET CALLE = 'PRES. NICOLAS AVELLANEDA' WHERE	LUGAR LIKE ('AV PRESIDENTE  AL 4500%') OR
																LUGAR LIKE ('AV. PTE. N. AVELLANEDA 4500%');

UPDATE AUX_ACTAS SET CALLE = 'AV. GDOR. PUJOL' WHERE	LUGAR LIKE ('AV PUJ%') OR
														LUGAR LIKE ('AV. GDOR PUJ%') OR
														LUGAR LIKE ('AV. GOBERNADOR PUJ%') OR
														LUGAR LIKE ('AV. J. PUJ%') OR
														LUGAR LIKE ('AV. JUAN PU%') OR
														LUGAR LIKE ('AV. PUJ%') OR
														LUGAR LIKE ('AVENIDA PUJ%') OR
														LUGAR LIKE ('GOB. PUJ%') OR
														LUGAR LIKE ('JUAN PUJ%') OR
														LUGAR LIKE ('AVENIDA PONCHO%') OR
														LUGAR LIKE ('BRASIL Y PON%') OR
														LUGAR LIKE ('PONCHOV%') OR
														LUGAR LIKE ('PUJ%');

UPDATE AUX_ACTAS SET CALLE = 'ACCESO A PERICHON' WHERE	LUGAR LIKE ('ACCESO A PERICHON%') OR
														LUGAR LIKE ('INGRESO A PERICHON%') OR
														LUGAR LIKE ('AV RUTA 12 Y PERICHON%') OR
														LUGAR LIKE ('PERICHON%') OR
														LUGAR LIKE ('RUTA 12  Y PERICHON%') OR
														LUGAR LIKE ('RUTA 12 ACC. PERICHON%') OR
														LUGAR LIKE ('RUTA 12 ENTRADA PERICH+ÆN%') OR
														LUGAR LIKE ('RUTA 12 INGRESO AL PERICHON') OR
														LUGAR LIKE ('RUTA 12 Y PERICHON');

UPDATE AUX_ACTAS SET CALLE = 'AV. TTE. IBAÑEZ' WHERE	LUGAR LIKE ('AV T. IBA%') OR
														LUGAR LIKE ('AV TTE%') OR
														LUGAR LIKE ('AV. TENIENTE%') OR
														LUGAR LIKE ('T. IBA%') OR
														LUGAR LIKE ('TENIENTE IBA%') OR
														LUGAR LIKE ('TTE IBA%') OR
														LUGAR LIKE ('TTE. IBA%') OR
														LUGAR LIKE ('AV T. IBA%') OR
														LUGAR LIKE ('AV TTE%') OR
														LUGAR LIKE ('AV. TENIENTE%') OR
														LUGAR LIKE ('T. IBA%') OR
														LUGAR LIKE ('TENIENTE IBA%') OR
														LUGAR LIKE ('TTE IBA%') OR
														LUGAR LIKE ('TTE. IBA%');

UPDATE AUX_ACTAS SET CALLE = 'ALVEAR' WHERE	LUGAR LIKE ('AV. ALVEAR AL 1400%');

UPDATE AUX_ACTAS SET CALLE = 'AV. JUAN DE GARAY' WHERE	LUGAR LIKE ('AV. GARAY 2900%');

UPDATE AUX_ACTAS SET CALLE = 'AV. ITALIA' WHERE	LUGAR LIKE ('AV. ITA%') OR
												LUGAR LIKE ('ITAL%');

UPDATE AUX_ACTAS SET CALLE = 'AV. JUAN DOMINGO PERON' WHERE	LUGAR LIKE ('AV. J.D%') OR
															LUGAR LIKE ('AV. JUAN D%') OR
															LUGAR LIKE ('AV. PERON%') OR
															LUGAR LIKE ('JUAN DOM%') OR
															LUGAR LIKE ('JUAN D.%');

UPDATE AUX_ACTAS SET CALLE = 'AV. JUAN RAMON VIDAL' WHERE	LUGAR LIKE ('AV. J.R. V%') OR
															LUGAR LIKE ('J.R. VIDAL 2490%') OR
															LUGAR LIKE ('J.R.VIDAL 2490%') OR
															LUGAR LIKE ('JUAN RAM%');

UPDATE AUX_ACTAS SET CALLE = 'JOSE RAMON VIDAL' WHERE	LUGAR LIKE ('J. R V%') OR
														LUGAR LIKE ('J. R. V%') OR
														LUGAR LIKE ('J.R V%') OR
														LUGAR LIKE ('J.R. V%') OR
														LUGAR LIKE ('J.R.V%') OR
														LUGAR LIKE ('JOSE RAM%') OR
														LUGAR LIKE ('JR VID%') OR
														LUGAR LIKE ('JR. VID%');

UPDATE AUX_ACTAS SET CALLE = 'AV. JUAN RAMON VIDAL' WHERE	LUGAR LIKE ('AV. J.R. V%') OR
															LUGAR LIKE ('J.R. VIDAL 2490%') OR
															LUGAR LIKE ('J.R.VIDAL 2490%') OR
															LUGAR LIKE ('JUAN RAM%');

UPDATE AUX_ACTAS SET CALLE = 'AV. LA PAZ' WHERE	LUGAR LIKE ('AV. J. M. ES%') OR
												LUGAR LIKE ('AV. J.M. ES%') OR
												LUGAR LIKE ('AV. LA PAZ%') OR
												LUGAR LIKE ('AVENIDA LA PAZ%') OR
												LUGAR LIKE ('ESTRA%') OR
												LUGAR LIKE ('J. M. ESTRA%') OR
												LUGAR LIKE ('J. MANUEL ESTR%') OR
												LUGAR LIKE ('JUAN JOSE ESTR%');

UPDATE AUX_ACTAS SET CALLE = 'GRAL. PAZ' WHERE	LUGAR LIKE ('AV ESTRADA Y GUTEMBERG%') OR
												LUGAR LIKE ('GENERAL PAZ%') OR
												LUGAR LIKE ('GRAL P%') OR
												LUGAR LIKE ('GRAL. PAZ%') OR
												LUGAR LIKE ('GUTEMBER Y GENERAL PAZ%');

UPDATE AUX_ACTAS SET CALLE = 'STA. ROSA' WHERE	LUGAR LIKE ('AV. SANTA R%') OR
												LUGAR LIKE ('AV. STA R%') OR
												LUGAR LIKE ('AV. STA. R%') OR
												LUGAR LIKE ('SANTA R%') OR
												LUGAR LIKE ('STA R%');

UPDATE AUX_ACTAS SET CALLE = 'AV. SARMIENTO' WHERE	LUGAR LIKE ('AV. SARM%') OR
													LUGAR LIKE ('NECOCHEA Y SARMIENTO%') OR
													LUGAR LIKE ('SARM%');

UPDATE AUX_ACTAS SET CALLE = 'AV. AYACUCHO' WHERE	LUGAR LIKE ('AV.AYA%') OR
													LUGAR LIKE ('AVENIDA AYA%') OR
													LUGAR LIKE ('AYA%');

UPDATE AUX_ACTAS SET CALLE = 'CNEL. BAIBIENE' WHERE	LUGAR LIKE ('BAI%');

UPDATE AUX_ACTAS SET CALLE = 'UNNE' WHERE	LUGAR LIKE ('BARDO%') OR
											LUGAR LIKE ('DARDO%');

UPDATE AUX_ACTAS SET CALLE = 'BLAS BENJAMIN DE LA VEGA' WHERE	LUGAR LIKE ('BENJAM%');

UPDATE AUX_ACTAS SET CALLE = 'BOLIVAR' WHERE	LUGAR LIKE ('BOL+%') OR
												LUGAR LIKE ('BOLI%');

UPDATE AUX_ACTAS SET CALLE = 'BRASIL' WHERE	LUGAR LIKE ('BRAS%') OR
											LUGAR LIKE ('BRES%');

UPDATE AUX_ACTAS SET CALLE = 'BUENOS AIRES' WHERE	LUGAR LIKE ('BS%') OR
													LUGAR LIKE ('BUENOS%');

UPDATE AUX_ACTAS SET CALLE = 'CARLOS PELLEGRINI' WHERE	LUGAR LIKE ('C PEL%') OR
														LUGAR LIKE ('C. PEL%') OR
														LUGAR LIKE ('C.PEL%') OR
														LUGAR LIKE ('CARL%') OR
														LUGAR LIKE ('PEL%');

UPDATE AUX_ACTAS SET CALLE = 'CORDOBA' WHERE	LUGAR LIKE ('%DOBA%') OR
												LUGAR LIKE ('CORDA%');

UPDATE AUX_ACTAS SET CALLE = 'CAA GUAZU' WHERE	LUGAR LIKE ('%CAA%');

UPDATE AUX_ACTAS SET CALLE = 'CARIBE' WHERE	LUGAR LIKE ('CARIBE%') OR
											LUGAR LIKE ('PJE.CAR%');

UPDATE AUX_ACTAS SET CALLE = 'C. CARTAGENA' WHERE	LUGAR LIKE ('%CARTAGENA%');

UPDATE AUX_ACTAS SET CALLE = 'C. LAS PIEDRAS' WHERE	LUGAR LIKE ('%LAS PIED%');

UPDATE AUX_ACTAS SET CALLE = 'GDOR. CASTILLO' WHERE	LUGAR LIKE ('CASTI%') OR
													LUGAR LIKE ('GOBERNADOR CAST%');

UPDATE AUX_ACTAS SET CALLE = 'CEMENTERIO SAN ISIDRO' WHERE	LUGAR LIKE ('CEMENTERIO LAGUNA%');

UPDATE AUX_ACTAS SET CALLE = 'VEDIA' WHERE	LUGAR LIKE ('CEMENTERIO SAN JUAN%') OR
											LUGAR LIKE ('PLAYON DEL CEMENTERIO%');

UPDATE AUX_ACTAS SET CALLE = 'CHACO' WHERE	LUGAR LIKE ('CHACO%');

UPDATE AUX_ACTAS SET CALLE = 'COCOMAROLA' WHERE	LUGAR LIKE ('COCO%');

UPDATE AUX_ACTAS SET CALLE = 'COLOMBIA' WHERE	LUGAR LIKE ('COLOMBIA%');

UPDATE AUX_ACTAS SET CALLE = 'CUBA' WHERE	LUGAR LIKE ('CUBA%');

UPDATE AUX_ACTAS SET CALLE = 'TUCUMAN' WHERE	LUGAR LIKE ('CUCUM%') OR
												LUGAR LIKE ('TUCU%');

UPDATE AUX_ACTAS SET CALLE = 'DON BOSCO' WHERE	LUGAR LIKE ('DON BO%');

UPDATE AUX_ACTAS SET CALLE = 'DORREGO' WHERE	LUGAR LIKE ('DORREGO%');

UPDATE AUX_ACTAS SET CALLE = 'ELIAS ABAD' WHERE	LUGAR LIKE ('ELIAS%');

UPDATE AUX_ACTAS SET CALLE = 'ENTRE RIOS' WHERE	LUGAR LIKE ('ENTRE%') OR
												LUGAR LIKE ('RIVADAVIA 1500 Y EN OBSERVACIONES LA INSPECTORA DICE*DIGO ENTRE RIOS 1500*.');

UPDATE AUX_ACTAS SET CALLE = 'EX VIAS GRAL. URQUIZA' WHERE	LUGAR LIKE ('EX VIA%');

UPDATE AUX_ACTAS SET CALLE = 'FRAY JOSE DE LA QUINTANA' WHERE	LUGAR LIKE ('F. J Q%') OR
																LUGAR LIKE ('F. J. DE%') OR
																LUGAR LIKE ('F. J. Q%') OR
																LUGAR LIKE ('F. JOSE%') OR
																LUGAR LIKE ('F. QUIN%') OR
																LUGAR LIKE ('F.J%') OR
																LUGAR LIKE ('FJ DE LA%') OR
																LUGAR LIKE ('FRAY%') OR
																LUGAR LIKE ('QUINTANA%');

UPDATE AUX_ACTAS SET CALLE = 'GDOR. GONZALEZ' WHERE	LUGAR LIKE ('G. GON%') OR
													LUGAR LIKE ('G.GON%') OR
													LUGAR LIKE ('GDOR GON%') OR
													LUGAR LIKE ('GDOR. GON%') OR
													LUGAR LIKE ('GOB. GON%') OR
													LUGAR LIKE ('GOBERNADOR GON%');

UPDATE AUX_ACTAS SET CALLE = 'GDOR. GALLINO' WHERE	LUGAR LIKE ('GOB. GALLI%');

UPDATE AUX_ACTAS SET CALLE = 'GODOY CRUZ' WHERE	LUGAR LIKE ('GODOY CRUZ%');

UPDATE AUX_ACTAS SET CALLE = 'ROCA' WHERE	LUGAR LIKE ('GRAL. ROCA%') OR
											LUGAR LIKE ('ROCA%') OR
											LUGAR LIKE ('ROKA 800%') OR
											LUGAR LIKE ('SARGENTO Y ROCA%');

UPDATE AUX_ACTAS SET CALLE = 'SANTA FE' WHERE	LUGAR LIKE ('FANTA%') OR
												LUGAR LIKE ('SAN TA FE%') OR
												LUGAR LIKE ('SANTA FE%') OR
												LUGAR LIKE ('SANYA FE%') OR
												LUGAR LIKE ('SSANTA FE%') OR
												LUGAR LIKE ('SANTA  FE%') OR
												LUGAR LIKE ('SANTA AL 900%') OR
												LUGAR LIKE ('SANTA DE%') OR
												LUGAR LIKE ('SANTA F%') OR
												LUGAR LIKE ('SANTE FE AL 1340%') OR
												LUGAR LIKE ('STA FE%');

UPDATE AUX_ACTAS SET CALLE = 'GUEMES' WHERE	LUGAR LIKE ('GUEMEZ%');

UPDATE AUX_ACTAS SET CALLE = 'GUTEMBERG' WHERE	LUGAR LIKE ('GUTEM%') OR
												LUGAR LIKE ('PATAGONIA Y GUTE%');

UPDATE AUX_ACTAS SET CALLE = 'AV. GUTNISKY' WHERE	LUGAR LIKE ('GUTNISKY%');

UPDATE AUX_ACTAS SET CALLE = 'C. HEROES CIVILES' WHERE	LUGAR LIKE ('HERO%');

UPDATE AUX_ACTAS SET CALLE = 'C. HEROES CIVILES' WHERE	LUGAR LIKE ('HERO%');

UPDATE AUX_ACTAS SET CALLE = 'IGARZABAL' WHERE	LUGAR LIKE ('IGAR%');

UPDATE AUX_ACTAS SET CALLE = 'C. IRALA' WHERE	LUGAR LIKE ('IRA%');

UPDATE AUX_ACTAS SET CALLE = 'ITUZAINGO' WHERE	LUGAR LIKE ('ITU%');

UPDATE AUX_ACTAS SET CALLE = 'J. M. ROLON' WHERE	LUGAR LIKE ('J ROL%') OR
													LUGAR LIKE ('ROL%');

UPDATE AUX_ACTAS SET CALLE = 'JUJUY' WHERE	LUGAR LIKE ('%JUY%') OR
											LUGAR LIKE ('JUJUI%');

UPDATE AUX_ACTAS SET CALLE = 'C. JOSEFINA CONTTE' WHERE	LUGAR LIKE ('J. CONTTE Y LAS VIOLETAS%');

UPDATE AUX_ACTAS SET CALLE = 'JUAN JOSE PASO' WHERE	LUGAR LIKE ('JUAN JOSE PASO AL 3081%');

UPDATE AUX_ACTAS SET CALLE = 'JUNIN' WHERE	LUGAR LIKE ('JUN%') OR
											LUGAR LIKE ('NUNIN%');

UPDATE AUX_ACTAS SET CALLE = 'LEOPOLDO LUGONES' WHERE	LUGAR LIKE ('L. LUG%') OR
														LUGAR LIKE ('LUGO%');

UPDATE AUX_ACTAS SET CALLE = 'LAMADRID' WHERE	LUGAR LIKE ('LA MADRID%') OR
												LUGAR LIKE ('LAMADRID%');

UPDATE AUX_ACTAS SET CALLE = 'LA RIOJA' WHERE	LUGAR LIKE ('LA RIO%') OR
												LUGAR LIKE ('RIOJA%');

UPDATE AUX_ACTAS SET CALLE = 'LAVALLE' WHERE	LUGAR LIKE ('%VALLE%');

UPDATE AUX_ACTAS SET CALLE = 'LAPACHO' WHERE	LUGAR LIKE ('LAPACHO%');

UPDATE AUX_ACTAS SET CALLE = 'LAPLACE' WHERE	LUGAR LIKE ('LAPLACE%');

UPDATE AUX_ACTAS SET CALLE = 'LARREA' WHERE	LUGAR LIKE ('LARREA%');

UPDATE AUX_ACTAS SET CALLE = 'LARRETA' WHERE	LUGAR LIKE ('LARRETA%');

UPDATE AUX_ACTAS SET CALLE = 'LAS CUEVAS' WHERE	LUGAR LIKE ('LAS CUEVAS%');

UPDATE AUX_ACTAS SET CALLE = 'LAS HERAS' WHERE	LUGAR LIKE ('LAS HE%');

UPDATE AUX_ACTAS SET CALLE = 'LAS MARGARITAS' WHERE	LUGAR LIKE ('LAS MARGA%');

UPDATE AUX_ACTAS SET CALLE = 'LAS VIOLETAS' WHERE	LUGAR LIKE ('LAS VIOLE%');

UPDATE AUX_ACTAS SET CALLE = 'SAN LORENZO' WHERE	LUGAR LIKE ('LORE%') OR
													LUGAR LIKE ('S. LORE%') OR
													LUGAR LIKE ('SAN LORE%') OR
													LUGAR LIKE ('SAN NLO%') OR
													LUGAR LIKE ('SN LORE%') OR
													LUGAR LIKE ('SQAN LORE%') OR
													LUGAR LIKE ('SSAN LORE%');

UPDATE AUX_ACTAS SET CALLE = 'LUIS BRAILLE' WHERE	LUGAR LIKE ('LUISB.%');

UPDATE AUX_ACTAS SET CALLE = 'MARIANO MORENO' WHERE	LUGAR LIKE ('M. MORE%') OR
													LUGAR LIKE ('MARIANO M%') OR
													LUGAR LIKE ('MORENA%') OR
													LUGAR LIKE ('MORENO%');

UPDATE AUX_ACTAS SET CALLE = 'MADARIAGA' WHERE	LUGAR LIKE ('MADARIAGA%');

UPDATE AUX_ACTAS SET CALLE = 'MARIÑO' WHERE	LUGAR LIKE ('MARI+%');

UPDATE AUX_ACTAS SET CALLE = 'MENDOZA' WHERE	LUGAR LIKE ('MENDO%');

UPDATE AUX_ACTAS SET CALLE = 'MISIONES' WHERE	LUGAR LIKE ('MISI%');

UPDATE AUX_ACTAS SET CALLE = 'MURCIA' WHERE	LUGAR LIKE ('MURCIA%');

UPDATE AUX_ACTAS SET CALLE = 'NECOCHEA' WHERE	LUGAR LIKE ('%NECO%');

UPDATE AUX_ACTAS SET CALLE = 'C. NICARAGUA' WHERE	LUGAR LIKE ('%NICA%');

UPDATE AUX_ACTAS SET CALLE = 'P. NIVEIRO' WHERE	LUGAR LIKE ('P. NIVE%');

UPDATE AUX_ACTAS SET CALLE = 'PAGO LARGO' WHERE	LUGAR LIKE ('PAGO %');

UPDATE AUX_ACTAS SET CALLE = 'AV. PAYSANDU' WHERE	LUGAR LIKE ('PAISANDU%') OR
													LUGAR LIKE ('PAYS%') OR
													LUGAR LIKE ('TANQUE DE LAS 1000 VIV.%');

UPDATE AUX_ACTAS SET CALLE = 'PARAGUAY' WHERE	LUGAR LIKE ('PARA%');

UPDATE AUX_ACTAS SET CALLE = 'PERU' WHERE	LUGAR LIKE ('PERU%');

UPDATE AUX_ACTAS SET CALLE = 'PJE. FARIÑA' WHERE	LUGAR LIKE ('PASAJE FARIAS 2100%');

UPDATE AUX_ACTAS SET CALLE = 'PJE. TORRENT' WHERE	LUGAR LIKE ('PASAJE TORREN 986%');

UPDATE AUX_ACTAS SET CALLE = 'PITAGORAS' WHERE	LUGAR LIKE ('PITA%');

UPDATE AUX_ACTAS SET CALLE = 'REPUBLICA DEL LIBANO' WHERE	LUGAR LIKE ('R. LIB%') OR
															LUGAR LIKE ('REP+¦BLICA DEL L+¡BANO AL 200%') OR
															LUGAR LIKE ('REPUBLICA DEL LIBANO%');

UPDATE AUX_ACTAS SET CALLE = 'C. CANGALLO' WHERE	LUGAR LIKE ('RAMOS MEJIAS Y CANGALLO%');

UPDATE AUX_ACTAS SET CALLE = 'RECONQUISTA' WHERE	LUGAR LIKE ('RECONQUISTA AL 3277%');

UPDATE AUX_ACTAS SET CALLE = 'REMEDIOS DE ESCALADA' WHERE	LUGAR LIKE ('REMEDIO DE ESCALADA 5001%');

UPDATE AUX_ACTAS SET CALLE = 'RIVADAVIA' WHERE	LUGAR LIKE ('RIV%');

UPDATE AUX_ACTAS SET CALLE = 'RUTA 12' WHERE	LUGAR LIKE ('%RUTA 12%');

UPDATE AUX_ACTAS SET CALLE = 'RUTA 5' WHERE	LUGAR LIKE ('%RUTA 5%');

UPDATE AUX_ACTAS SET CALLE = 'SALTA' WHERE	LUGAR LIKE ('SALTA%');

UPDATE AUX_ACTAS SET CALLE = 'SAN LUIS' WHERE	LUGAR LIKE ('SAN LU%');

UPDATE AUX_ACTAS SET CALLE = 'PJE. CABRAL' WHERE	LUGAR LIKE ('SARG%') OR
													LUGAR LIKE ('STO. C%');

UPDATE AUX_ACTAS SET CALLE = 'SAAVEDRA' WHERE	LUGAR LIKE ('SAVEDRA%');

UPDATE AUX_ACTAS SET CALLE = 'TACUARI' WHERE	LUGAR LIKE ('TAC%');

UPDATE AUX_ACTAS SET CALLE = 'TILCARA' WHERE	LUGAR LIKE ('TILCARA%');

UPDATE AUX_ACTAS SET CALLE = 'C. LORETO' WHERE	LUGAR LIKE ('TRENTON Y LORETO%');

UPDATE AUX_ACTAS SET CALLE = 'TURIN' WHERE	LUGAR LIKE ('TURIN 2800%');

UPDATE AUX_ACTAS SET CALLE = 'URUGUAY' WHERE	LUGAR LIKE ('URU%');

UPDATE AUX_ACTAS SET CALLE = 'VELEZ SARSFIELD' WHERE	LUGAR LIKE ('V. SAR%') OR
														LUGAR LIKE ('VELEZ%');

UPDATE AUX_ACTAS SET CALLE = 'VIEDMA' WHERE	LUGAR LIKE ('VIEDMA 1200%');

UPDATE AUX_ACTAS SET CALLE = 'DR. W DOMINGUEZ' WHERE	LUGAR LIKE ('W%');

UPDATE AUX_ACTAS SET CALLE = 'ZARATE' WHERE	LUGAR LIKE ('Z%');

UPDATE AUX_ACTAS SET CALLE = TRIM(CALLE);
UPDATE AUX_ACTAS SET ALTURA = TRIM(ALTURA);

-- CRACION DE AUXILIARES Y CORRECCIONES 

alter table aux_actas add altura2 varchar(10);
update AUX_ACTAS set altura2 = altura;

UPDATE AUX_ACTAS SET altura2 = dbo.RemoverNoNumericos(altura2);
UPDATE AUX_ACTAS SET ALTURA2 = '1000' WHERE CALLE = 'AV. COSTANERA GRAL. SAN MARTIN' AND LUGAR LIKE ('PLAY%');
UPDATE AUX_ACTAS SET ALTURA2 = '1030' WHERE CALLE = 'ACCESO A PERICHON';
UPDATE AUX_ACTAS SET CALLE = 'RUTA 12' WHERE CALLE = 'ACCESO A PERICHON';
UPDATE AUX_ACTAS SET ALTURA2 = '1030' WHERE ALTURA LIKE ('%CHON%');
UPDATE AUX_ACTAS SET ALTURA2 = '3500' WHERE CALLE = 'NECOCHEA' AND ALTURA LIKE ('%HEA%');
UPDATE AUX_ACTAS SET ALTURA2 = '1600' WHERE ALTURA LIKE ('%FE%');
UPDATE AUX_ACTAS SET ALTURA2 = '3400' WHERE ALTURA LIKE ('%ELA%');
UPDATE AUX_ACTAS SET ALTURA2 = '900' WHERE ALTURA LIKE ('%LTA%');
UPDATE AUX_ACTAS SET ALTURA2 = '1400' WHERE ALTURA LIKE ('%RCA%');
UPDATE AUX_ACTAS SET ALTURA2 = '3000' WHERE ALTURA LIKE ('%BUCO%');
UPDATE AUX_ACTAS SET ALTURA2 = TRIM(ALTURA2);

-- ELIMINACION DE REGISTROS IRREGULARES

DELETE FROM AUX_ACTAS WHERE LUGAR = '1619';
DELETE FROM AUX_ACTAS WHERE LUGAR = 'AUSENTE';
DELETE FROM AUX_ACTAS WHERE LUGAR = 'AV PATAGONIA Y ARTIGA';
DELETE FROM AUX_ACTAS WHERE LUGAR = 'PATAGONIA Y PATAGONIA';
DELETE FROM AUX_ACTAS WHERE LUGAR = 'AVENIDA';
DELETE FROM AUX_ACTAS WHERE LUGAR = 'C';
DELETE FROM AUX_ACTAS WHERE LUGAR = 'C. PRADA AL 2400';
DELETE FROM AUX_ACTAS WHERE LUGAR LIKE ('CABECERA%');
DELETE FROM AUX_ACTAS WHERE LUGAR = 'CASCO 1200';
DELETE FROM AUX_ACTAS WHERE LUGAR = 'CENTRO';
DELETE FROM AUX_ACTAS WHERE LUGAR = 'DUNAS Y SAN FRANCISCO';
DELETE FROM AUX_ACTAS WHERE LUGAR = 'GUTIERREZ Y USUAHIA';
DELETE FROM AUX_ACTAS WHERE LUGAR = 'MONTECARLO Y RIO JURAMENTO';
DELETE FROM AUX_ACTAS WHERE LUGAR = 'MONZON AL 1200';
DELETE FROM AUX_ACTAS WHERE LUGAR LIKE('NO %');
DELETE FROM AUX_ACTAS WHERE LUGAR = 'P.  1384';
DELETE FROM AUX_ACTAS WHERE LUGAR = 'RENE FAVALORO Y AGUIRRE';
DELETE FROM AUX_ACTAS WHERE LUGAR = 'RIO PARANA S/N';
DELETE FROM AUX_ACTAS WHERE LUGAR = 'TARJETERO MARTINEZ DIEGO FAVIAN';
DELETE FROM AUX_ACTAS WHERE LUGAR = 'VIA PUBLICA';
DELETE FROM AUX_ACTAS WHERE LUGAR = 'CORRIENTES';
DELETE FROM AUX_ACTAS WHERE ALTURA2 = '';

-- CAMBIO DE TIPO DE DATO 

UPDATE AUX_ACTAS SET ALTURA = ALTURA2;

ALTER TABLE AUX_ACTAS ALTER COLUMN ALTURA INT;
ALTER TABLE AUX_ACTAS ADD ALTURA_PROMEDIO INT;


-----------------------------------------------------------------------------------------------------------

SELECT DISTINCT LUGAR FROM AUX_ACTAS WHERE LUGAR LIKE('%ERTO%') ORDER BY LUGAR;

SELECT DISTINCT LUGAR2 FROM AUX_ACTAS ORDER BY LUGAR2;

SELECT * FROM AUX_ACTAS ORDER BY ALTURA;

SELECT * FROM AUX_ACTAS WHERE LEN(ALTURA) = 3;
SELECT * FROM AUX_ACTAS	WHERE ISNUMERIC(ALTURA) = 0;

alter table aux_actas add altura2 varchar(10);
update AUX_ACTAS set altura2 = altura;

SELECT ALTURA, dbo.RemoverNoNumericos(ALTURA) FROM AUX_ACTAS;



SELECT * FROM AUX_ACTAS WHERE ALTURA LIKE ('%RCA%') ORDER BY ALTURA;

SELECT COUNT(DISTINCT CALLE) FROM AUX_ACTAS ORDER BY CALLE;



UPDATE AUX_ACTAS SET LUGAR2 = 'ACCESO A PERICHON' WHERE	LUGAR LIKE ('%ACCE%') OR
														LUGAR LIKE ('%ACCC%') OR
														LUGAR LIKE ('%RUTA 12 Y PRICHON%');
--------------------------------------------------------------------------------------------------------------



--CRECION Y CARGA DE TABLA A UTILIZAR 

DROP TABLE ACTAS_INFRACCION;

CREATE TABLE ACTAS_INFRACCION (
	ID_ACTA INT NOT NULL PRIMARY KEY IDENTITY(1,1),
	FECHA DATE,
	TIPO_VEHICULO VARCHAR(100),
	CALLE VARCHAR(150),
	ID_CALLE INT,
	ALTURA INT
);

INSERT INTO ACTAS_INFRACCION (FECHA, TIPO_VEHICULO, CALLE, ALTURA)
SELECT FECHA, TIPO_VEHICULO, CALLE, ALTURA 
FROM AUX_ACTAS
ORDER BY FECHA, CALLE, ALTURA;

DROP TABLE CALLES;

CREATE TABLE CALLES (
	ID_CALLE INT NOT NULL PRIMARY KEY IDENTITY(1,1),
	CALLE VARCHAR(100)
);

INSERT INTO CALLES (CALLE)
SELECT DISTINCT CALLE 
FROM AUX_ACTAS
ORDER BY CALLE;

UPDATE ACTAS_INFRACCION
SET ACTAS_INFRACCION.ID_CALLE = CALLES.ID_CALLE
FROM ACTAS_INFRACCION
INNER JOIN CALLES ON ACTAS_INFRACCION.CALLE = CALLES.CALLE;

--CORRECCION DE TABLA ACTAS_INFRACCION

DELETE FROM ACTAS_INFRACCION WHERE CALLE = '25 DE MAYO' AND ALTURA > 2000;
DELETE FROM ACTAS_INFRACCION WHERE CALLE = '9 DE JULIO' AND ALTURA < 200;
UPDATE ACTAS_INFRACCION SET ALTURA = 400 WHERE CALLE = 'A. C. FERNANDEZ';
UPDATE ACTAS_INFRACCION SET ALTURA = 3100 WHERE CALLE = 'ACONCAGUA';
UPDATE ACTAS_INFRACCION SET ALTURA = 3000 WHERE CALLE = 'ALTA GRACIA';
UPDATE ACTAS_INFRACCION SET CALLE = 'AV. 3 DE ABRIL' WHERE CALLE = 'AV. FERRE';
UPDATE ACTAS_INFRACCION SET ID_CALLE = 9 WHERE ID_CALLE = 19;
UPDATE ACTAS_INFRACCION SET CALLE = 'AV. INDEPENDENCIA' WHERE CALLE = 'AV. 3 DE ABRIL' AND ALTURA > 3000;
UPDATE ACTAS_INFRACCION SET ID_CALLE = 23 WHERE ID_CALLE = 9 AND ALTURA > 3000;
UPDATE ACTAS_INFRACCION SET ALTURA = 1800 WHERE CALLE = 'AV. ARGENTINA';
UPDATE ACTAS_INFRACCION SET CALLE = 'AV. ARMENIA' WHERE CALLE = 'AV. GDOR. RUIZ' AND ALTURA >= 2900;
UPDATE ACTAS_INFRACCION SET ID_CALLE = 12 WHERE ID_CALLE = 21 AND ALTURA >= 2900;
UPDATE ACTAS_INFRACCION SET CALLE = 'AV. GDOR. RUIZ' WHERE CALLE = 'AV. ARMENIA' AND ALTURA < 2900;
UPDATE ACTAS_INFRACCION SET ID_CALLE = 21 WHERE ID_CALLE = 12 AND ALTURA < 2900;
UPDATE ACTAS_INFRACCION SET ALTURA = 1400 WHERE CALLE = 'AV. ARTIGAS';
UPDATE ACTAS_INFRACCION SET ALTURA = 3000 WHERE CALLE = 'AV. AYACUCHO';
UPDATE ACTAS_INFRACCION SET CALLE = 'AV. CAZADORES CORRENTINOS' WHERE CALLE = 'PRES. NICOLAS AVELLANEDA' AND CALLE = 'AV. JUAN DOMINGO PERON';
UPDATE ACTAS_INFRACCION SET ID_CALLE = 15 WHERE ID_CALLE = 111 AND ID_CALLE = 26;
DELETE FROM ACTAS_INFRACCION WHERE CALLE = 'AV. CAZADORES CORRENTINOS' AND ALTURA NOT BETWEEN 2700 AND 3700;
DELETE FROM ACTAS_INFRACCION WHERE ID_CALLE = 15 AND ALTURA NOT BETWEEN 2700 AND 3700;
UPDATE ACTAS_INFRACCION SET ALTURA = 3200 WHERE CALLE = 'AV. CENTENARIO';
DELETE FROM ACTAS_INFRACCION WHERE CALLE = 'AV. CHACABUCO' AND ALTURA NOT BETWEEN 700 AND 1700;
UPDATE ACTAS_INFRACCION SET CALLE = 'AV. COSTANERA GRAL. SAN MARTIN' WHERE CALLE = 'PLACIDO MARTINEZ' AND ALTURA < 700;
UPDATE ACTAS_INFRACCION SET ID_CALLE = 18 WHERE ID_CALLE = 110 AND ALTURA < 700;
UPDATE ACTAS_INFRACCION SET CALLE = 'PLACIDO MARTINEZ' WHERE CALLE = 'AV. JUAN TORRES DE VERA Y ARAGON' AND ALTURA BETWEEN 700 AND 1000;
UPDATE ACTAS_INFRACCION SET ID_CALLE = 110 WHERE ID_CALLE = 28 AND ALTURA BETWEEN 700 AND 1000;
UPDATE ACTAS_INFRACCION SET CALLE = 'AV. COSTANERA GRAL. SAN MARTIN' WHERE CALLE = 'AV. JUAN TORRES DE VERA Y ARAGON' AND ALTURA < 700;
UPDATE ACTAS_INFRACCION SET ID_CALLE = 18 WHERE ID_CALLE = 28 AND ALTURA < 700;
DELETE FROM ACTAS_INFRACCION WHERE CALLE = 'AV. GDOR. PUJOL' AND ALTURA < 1500;
DELETE FROM ACTAS_INFRACCION WHERE CALLE = 'AV. GDOR. RUIZ' AND ALTURA < 2300;
UPDATE ACTAS_INFRACCION SET ALTURA = 2350 WHERE CALLE = 'AV. GDOR. RUIZ';
DELETE FROM ACTAS_INFRACCION WHERE CALLE = 'AV. INDEPENDENCIA' AND ALTURA <= 3000;
UPDATE ACTAS_INFRACCION SET ALTURA = 400 WHERE CALLE = 'AV. ITALIA';
UPDATE ACTAS_INFRACCION SET ALTURA = 300 WHERE CALLE = 'AV. JUAN DE GARAY';
DELETE FROM ACTAS_INFRACCION WHERE CALLE = 'AV. JUAN DOMINGO PERON' AND ALTURA <= 3000;
DELETE FROM ACTAS_INFRACCION WHERE CALLE = 'AV. JUAN RAMON VIDAL' AND ALTURA <= 1700;
DELETE FROM ACTAS_INFRACCION WHERE CALLE = 'AV. JUAN TORRES DE VERA Y ARAGON' AND ALTURA > 1500;
UPDATE ACTAS_INFRACCION SET ALTURA = 1400 WHERE CALLE = 'AV. JUAN TORRES DE VERA Y ARAGON';
UPDATE ACTAS_INFRACCION SET ALTURA = 2400 WHERE CALLE = 'AV. LA PAZ';
UPDATE ACTAS_INFRACCION SET ALTURA = 5700 WHERE CALLE = 'AV. LIBERTAD';
UPDATE ACTAS_INFRACCION SET ALTURA = 1300 WHERE CALLE = 'AV. NARCISO LAPRIDA';
UPDATE ACTAS_INFRACCION SET ALTURA = 1800 WHERE CALLE = 'AV. PATAGONIA';
UPDATE ACTAS_INFRACCION SET ALTURA = 3200 WHERE CALLE = 'AV. RAUL ALFONSIN' AND ALTURA <= 3200;
UPDATE ACTAS_INFRACCION SET ALTURA = 3500 WHERE CALLE = 'AV. RAUL ALFONSIN' AND ALTURA > 3200;
UPDATE ACTAS_INFRACCION SET ALTURA = 1733 WHERE CALLE = 'AV. SARMIENTO' AND ALTURA <= 1800;
DELETE FROM ACTAS_INFRACCION WHERE CALLE = 'BELGRANO' AND ALTURA > 2600;
DELETE FROM ACTAS_INFRACCION WHERE CALLE = 'BOLIVAR' AND ALTURA > 2600;
UPDATE ACTAS_INFRACCION SET ALTURA = 200 WHERE CALLE = 'BOLIVAR' AND ALTURA < 300;
DELETE FROM ACTAS_INFRACCION WHERE CALLE = 'BUENOS AIRES' AND ALTURA NOT BETWEEN 400 AND 1600;
UPDATE ACTAS_INFRACCION SET ALTURA = 2400 WHERE CALLE = 'C. IRALA';
UPDATE ACTAS_INFRACCION SET ALTURA = 3100 WHERE CALLE = 'C. NICARAGUA';
DELETE FROM ACTAS_INFRACCION WHERE CALLE = 'CARLOS PELLEGRINI' AND ALTURA NOT BETWEEN 400 AND 2200;
DELETE FROM ACTAS_INFRACCION WHERE CALLE = 'CATAMARCA' AND ALTURA NOT BETWEEN 300 AND 1600;
DELETE FROM ACTAS_INFRACCION WHERE CALLE = 'CORDOBA' AND ALTURA NOT BETWEEN 300 AND 1600;
DELETE FROM ACTAS_INFRACCION WHERE CALLE = 'COSQUIN' AND ALTURA > 2300;
UPDATE ACTAS_INFRACCION SET ALTURA = 2500 WHERE CALLE = 'DR. W DOMINGUEZ';
DELETE FROM ACTAS_INFRACCION WHERE CALLE = 'ESPAÑA' AND ALTURA NOT BETWEEN 300 AND 1600;
DELETE FROM ACTAS_INFRACCION WHERE CALLE = 'FRAY JOSE DE LA QUINTANA' AND ALTURA NOT BETWEEN 600 AND 1900;
UPDATE ACTAS_INFRACCION SET ALTURA = 1800 WHERE CALLE = 'GDOR. CASTILLO';
UPDATE ACTAS_INFRACCION SET ALTURA = 1600 WHERE CALLE = 'GDOR. GONZALEZ';
UPDATE ACTAS_INFRACCION SET ALTURA = 950 WHERE CALLE = 'GREGORIO POMAR';
UPDATE ACTAS_INFRACCION SET ALTURA = 1600 WHERE CALLE = 'GUTEMBERG';
UPDATE ACTAS_INFRACCION SET ALTURA = 1800 WHERE CALLE = 'JOSE RAMON VIDAL';
DELETE FROM ACTAS_INFRACCION WHERE CALLE = 'JUJUY' AND ALTURA NOT BETWEEN 400 AND 1600;
DELETE FROM ACTAS_INFRACCION WHERE CALLE = 'LA RIOJA' AND ALTURA NOT BETWEEN 400 AND 1600;
UPDATE ACTAS_INFRACCION SET ALTURA = 1000 WHERE CALLE = 'LAS HERAS';
UPDATE ACTAS_INFRACCION SET ALTURA = 600 WHERE CALLE = 'LEOPOLDO LUGONES';
UPDATE ACTAS_INFRACCION SET ALTURA = 5700 WHERE CALLE = 'LOS GIRASOLES';
DELETE FROM ACTAS_INFRACCION WHERE CALLE = 'MEDRANO' AND ALTURA NOT BETWEEN 1000 AND 2900;
DELETE FROM ACTAS_INFRACCION WHERE CALLE = 'MISIONES' AND ALTURA NOT BETWEEN 700 AND 1600;
DELETE FROM ACTAS_INFRACCION WHERE CALLE = 'MENDOZA' AND ALTURA NOT BETWEEN 300 AND 1600;
DELETE FROM ACTAS_INFRACCION WHERE CALLE = 'NECOCHEA' AND ALTURA NOT BETWEEN 100 AND 5000;
DELETE FROM ACTAS_INFRACCION WHERE CALLE = 'NUESTRA SEÑORA DE LA ASUNCION' AND ALTURA > 2600;
DELETE FROM ACTAS_INFRACCION WHERE CALLE = 'PERU' AND ALTURA < 1000;
UPDATE ACTAS_INFRACCION SET ALTURA = 1000 WHERE CALLE = 'PJE. AGUSTIN GONZALEZ';
UPDATE ACTAS_INFRACCION SET ALTURA = 2050 WHERE CALLE = 'PJE. CABRAL';
UPDATE ACTAS_INFRACCION SET ALTURA = 950 WHERE CALLE = 'PJE. TORRENT';
DELETE FROM ACTAS_INFRACCION WHERE CALLE = 'PLACIDO MARTINEZ' AND ALTURA > 1800;
DELETE FROM ACTAS_INFRACCION WHERE CALLE = 'PRES. NICOLAS AVELLANEDA';
UPDATE ACTAS_INFRACCION SET ALTURA = 2100 WHERE CALLE = 'RAFAELA';
DELETE FROM ACTAS_INFRACCION WHERE CALLE = 'RIVADAVIA' AND ALTURA NOT BETWEEN 300 AND 2600;
DELETE FROM ACTAS_INFRACCION WHERE CALLE = 'ROCA' AND ALTURA NOT BETWEEN 800 AND 1600;
DELETE FROM ACTAS_INFRACCION WHERE CALLE = 'RUTA 12' AND ALTURA = 12;
UPDATE ACTAS_INFRACCION SET ALTURA = 5 WHERE CALLE = 'RUTA 5';
DELETE FROM ACTAS_INFRACCION WHERE CALLE = 'SALTA' AND ALTURA < 400;
DELETE FROM ACTAS_INFRACCION WHERE CALLE = 'SAN JUAN' AND ALTURA NOT BETWEEN 500 AND 1600;
DELETE FROM ACTAS_INFRACCION WHERE CALLE = 'SAN LORENZO' AND ALTURA NOT BETWEEN 300 AND 1600;
DELETE FROM ACTAS_INFRACCION WHERE CALLE = 'SAN LUIS' AND ALTURA NOT BETWEEN 400 AND 1600;
DELETE FROM ACTAS_INFRACCION WHERE CALLE = 'SAN MARTIN' AND ALTURA NOT BETWEEN 50 AND 2500;
DELETE FROM ACTAS_INFRACCION WHERE CALLE = 'SANCHEZ DE BUSTAMANTE' AND ALTURA < 1200;
DELETE FROM ACTAS_INFRACCION WHERE CALLE = 'SANTA FE' AND ALTURA NOT BETWEEN 300 AND 1600;
UPDATE ACTAS_INFRACCION SET ALTURA = 1700 WHERE CALLE = 'STA. ROSA';
UPDATE ACTAS_INFRACCION SET ALTURA = 2200 WHERE CALLE = 'TACUARI' AND ALTURA > 2200;
UPDATE ACTAS_INFRACCION SET ALTURA = 450 WHERE CALLE = 'UNNE';

-- CREACION DE PROCEDIMIENTO PARA OBTENER PROMEDIO DE ALTURAS

ALTER TABLE ACTAS_INFRACCION ADD ALTURA_PROMEDIO INT;

DROP PROCEDURE PROMEDIAR_ALTURA;

CREATE PROCEDURE PROMEDIAR_ALTURA
AS
BEGIN

    DECLARE @ALTURA_INICIAL INT = 0;
    DECLARE @ALTURA_FINAL INT = 200;
    DECLARE @PROMEDIO_ALTURA INT;
    DECLARE @ID_CALLE INT;

    DECLARE CALLE_CURSOR CURSOR FOR
    SELECT DISTINCT ID_CALLE
    FROM ACTAS_INFRACCION;

    OPEN CALLE_CURSOR;

    FETCH NEXT FROM CALLE_CURSOR INTO @ID_CALLE;

    WHILE @@FETCH_STATUS = 0
    BEGIN

        WHILE @ALTURA_FINAL <= 7200
        BEGIN

            SELECT @PROMEDIO_ALTURA = FLOOR(AVG(ALTURA))
            FROM ACTAS_INFRACCION
            WHERE ID_CALLE = @ID_CALLE AND ALTURA > @ALTURA_INICIAL AND ALTURA <= @ALTURA_FINAL;

            UPDATE ACTAS_INFRACCION
            SET ALTURA_PROMEDIO = @PROMEDIO_ALTURA
            WHERE ID_CALLE = @ID_CALLE AND ALTURA > @ALTURA_INICIAL AND ALTURA <= @ALTURA_FINAL;

            SET @ALTURA_INICIAL = @ALTURA_INICIAL + 200;
            SET @ALTURA_FINAL = @ALTURA_FINAL + 200;
        END;

        SET @ALTURA_INICIAL = 0;
        SET @ALTURA_FINAL = 200;

        FETCH NEXT FROM CALLE_CURSOR INTO @ID_CALLE;
    END;

    CLOSE CALLE_CURSOR;
    DEALLOCATE CALLE_CURSOR;

END;

EXEC PROMEDIAR_ALTURA;

--CREACION TABLA AUXILIAR UBICACION Y CARGA CON DATOS LIMPIOS

DROP TABLE UBICACION;

CREATE TABLE UBICACION (
	CALLE VARCHAR(100),
	ALTURA_PROM INT,
	LATITUD DECIMAL(10,6),
	LONGITUD DECIMAL(10,6),
	CONSTRAINT PK_UBICACION PRIMARY KEY (CALLE, ALTURA_PROM)
);

INSERT INTO UBICACION (CALLE, ALTURA_PROM, LATITUD, LONGITUD)
VALUES
('11 DE MAYO', 800,-27.46758, -58.80771),
('20 DE MAYO',	700,-27.46870, -58.80390),
('25 DE MAYO',	600,-27.46363, -58.84276),
('25 DE MAYO',	738,-27.46379, -58.84081),
('25 DE MAYO',	1000,-27.46412, -58.83776),
('25 DE MAYO',	1185,-27.46435, -58.83544),
('25 DE MAYO',	1354,-27.46458, -58.83329),
('25 DE MAYO',	1496,-27.46475, -58.83144),
('25 DE MAYO',	1689,-27.46499, -58.82905),
('25 DE MAYO',	1861,-27.46516, -58.82700),
('9 DE JULIO',	306,-27.46566, -58.84659),
('9 DE JULIO',	755,-27.46610, -58.84100),
('9 DE JULIO',	945,-27.46631, -58.83857),
('9 DE JULIO',	1128,-27.46648, -58.83634),
('9 DE JULIO',	1338,-27.46669, -58.83376),
('9 DE JULIO',	1524,-27.46689, -58.83126),
('9 DE JULIO',	1639,-27.46700, -58.82971),
('9 DE JULIO',	1921,-27.46730, -58.82578),
('9 DE JULIO',	2041,-27.46739, -58.82444),
('A. C. FERNANDEZ',	400,-27.48245, -58.82770),
('ACONCAGUA',	3100,-27.49843, -58.81582),
('ALTA GRACIA',	3000,-27.50790, -58.81235),
('ALVEAR',	1400,-27.46019, -58.82767),
('AV. 3 DE ABRIL',	394,-27.47449, -58.84633),
('AV. 3 DE ABRIL',	564,-27.47468, -58.84487),
('AV. 3 DE ABRIL',	698,-27.47490, -58.84298),
('AV. 3 DE ABRIL',	883,-27.47522, -58.84057),
('AV. 3 DE ABRIL',	1192,-27.47570, -58.83672),
('AV. 3 DE ABRIL',	1345,-27.47596, -58.83463),
('AV. 3 DE ABRIL',	1724,-27.47659, -58.82990),
('AV. 3 DE ABRIL',	1849,-27.47680, -58.82804),
('AV. 3 DE ABRIL',	2087,-27.47717, -58.82519),
('AV. 3 DE ABRIL',	2205,-27.47738, -58.82345),
('AV. 3 DE ABRIL',	2762,-27.47809, -58.81778),
('AV. ALBERDI',	2138,-27.48586, -58.84675),
('AV. ARGENTINA',	1800,-27.50141, -58.83304),
('AV. ARMENIA',	2933,-27.46745, -58.81229),
('AV. ARMENIA',	3125,-27.46731, -58.81049),
('AV. ARMENIA',	3264,-27.46715, -58.80790),
('AV. ARMENIA',	3800,-27.46825, -58.80378),
('AV. ARMENIA',	3901,-27.46879, -58.80194),
('AV. ARMENIA',	4200,-27.46888, -58.79870),
('AV. ARMENIA',	4400,-27.46841, -58.79684),
('AV. ARMENIA',	5361,-27.46669, -58.79005),
('AV. ARTIGAS',	1400,-27.47496, -58.81936),
('AV. AYACUCHO',	3000,-27.47117, -58.81281),
('AV. CAZADORES CORRENTINOS',	2800,-27.48644, -58.81856),
('AV. CAZADORES CORRENTINOS',	3000,-27.48684, -58.81616),
('AV. CAZADORES CORRENTINOS',	3121,-27.48699, -58.81418),
('AV. CAZADORES CORRENTINOS',	3361,-27.48722, -58.81170),
('AV. CENTENARIO',	3200,-27.49332, -58.83812),
('AV. CHACABUCO',	800,-27.46878, -58.81214),
('AV. CHACABUCO',	991,-27.47109, -58.81267),
('AV. CHACABUCO',	1107,-27.47217, -58.81304),
('AV. CHACABUCO',	1400,-27.47547, -58.81389),
('AV. CHACABUCO',	1520,-27.47685, -58.81428),
('AV. CHACABUCO',	1700,-27.47830, -58.81469),
('AV. COSTANERA GRAL. SAN MARTIN',	133,-27.46633, -58.85051),
('AV. COSTANERA GRAL. SAN MARTIN',	312,-27.46396, -58.84509),
('AV. COSTANERA GRAL. SAN MARTIN',	499,-27.46243, -58.84338),
('AV. COSTANERA GRAL. SAN MARTIN',	719,-27.46152, -58.84117),
('AV. COSTANERA GRAL. SAN MARTIN',	999,-27.46756, -58.85194),
('AV. COSTANERA GRAL. SAN MARTIN',	1150,-27.46908, -58.85315),
('AV. GDOR. PUJOL',	1557,-27.46120, -58.82972),
('AV. GDOR. PUJOL',	1800,-27.46293, -58.82711),
('AV. GDOR. PUJOL',	1912,-27.46401, -58.82557),
('AV. GDOR. PUJOL',	2067,-27.46635, -58.82269),
('AV. GDOR. PUJOL',	2330,-27.46782, -58.82096),
('AV. GDOR. PUJOL',	2449,-27.46913, -58.81950),
('AV. GDOR. RUIZ',	2350,-27.46673, -58.82063),
('AV. GUTNISKY',	2500,-27.48805, -58.85179),
('AV. INDEPENDENCIA',	3400,-27.47908, -58.80973),
('AV. INDEPENDENCIA',	3600,-27.47934, -58.80755),
('AV. INDEPENDENCIA',	3766,-27.47955, -58.80587),
('AV. INDEPENDENCIA',	4000,-27.48016, -58.80324),
('AV. INDEPENDENCIA',	4150,-27.48070, -58.80134),
('AV. INDEPENDENCIA',	4319,-27.48142, -58.79885),
('AV. INDEPENDENCIA',	4700,-27.48247, -58.79520),
('AV. INDEPENDENCIA',	5100,-27.48384, -58.78950),
('AV. INDEPENDENCIA',	5400,-27.48412, -58.78528),
('AV. ITALIA',	400,-27.46215, -58.83638),
('AV. JUAN DE GARAY',	300,-27.49152, -58.85132),
('AV. JUAN RAMON VIDAL',	1965,-27.48178, -58.81533),
('AV. JUAN RAMON VIDAL',	2490,-27.48685, -58.81625),
('AV. JUAN TORRES DE VERA Y ARAGON',	1400,-27.46122, -58.83229),
('AV. LA PAZ',	2400,-27.48633, -58.82530),
('AV. LIBERTAD',	5700,-27.46357, -58.77740),
('AV. MAIPÚ',	111,-27.47735, -58.83032),
('AV. MAIPÚ',	336,-27.48056, -58.82782),
('AV. MAIPÚ',	500,-27.48180, -58.82681),
('AV. MAIPÚ',	799,-27.48619, -58.82335),
('AV. MAIPÚ',	1000,-27.48696, -58.82276),
('AV. MAIPÚ',	1178,-27.48740, -58.82240),
('AV. MAIPÚ',	1400,-27.49000, -58.82046),
('AV. MAIPÚ',	1529,-27.49273, -58.81886),
('AV. MAIPÚ',	1616,-27.49371, -58.81823),
('AV. MAIPÚ',	1900,-27.49513, -58.81728),
('AV. MAIPÚ',	2166,-27.49557, -58.81702),
('AV. MAIPÚ',	2396,-27.49718, -58.81592),
('AV. MAIPÚ',	2502,-27.49821, -58.81518),
('AV. MAIPÚ',	2752,-27.49925, -58.81447),
('AV. MAIPÚ',	2865,-27.50051, -58.81355),
('AV. MAIPÚ',	3260,-27.50316, -58.81241),
('AV. MAIPÚ',	3764,-27.50813, -58.81050),
('AV. MAIPÚ',	3869,-27.50897, -58.81033),
('AV. MAIPÚ',	5200,-27.51167, -58.80934),
('AV. NARCISO LAPRIDA',	1300,-27.47226, -58.78788),
('AV. PATAGONIA',	1800,-27.49179, -58.82913),
('AV. PAYSANDU',	3400,-27.49741, -58.82532),
('AV. PAYSANDU',	4350,-27.50628, -58.82627),
('AV. RAUL ALFONSIN',	3200,-27.47173, -58.81045),
('AV. RAUL ALFONSIN',	3500,-27.47251, -58.80720),
('AV. SARMIENTO',	1733,-27.47789, -58.83026),
('AV. SARMIENTO',	3206,-27.49489, -58.83218),
('AV. TTE. IBAÑEZ',	775,-27.48474, -58.84350),
('AV. TTE. IBAÑEZ',	850,-27.48483, -58.84241),
('AV. TTE. IBAÑEZ',	1100,-27.48528, -58.83866),
('AV. TTE. IBAÑEZ',	1800,-27.48455, -58.83028),
('AV. TTE. IBAÑEZ',	2200,-27.48259, -58.82420),
('AV. TTE. IBAÑEZ',	2400,-27.48221, -58.82299),
('BELGRANO',	800,-27.47170, -58.84088),
('BELGRANO',	944,-27.47189, -58.83890),
('BELGRANO',	1103,-27.47204, -58.83720),
('BELGRANO',	1307,-27.47227, -58.83493),
('BELGRANO',	1570,-27.47258, -58.83159),
('BELGRANO',	1673,-27.47278, -58.82967),
('BELGRANO',	1915,-27.47305, -58.82686),
('BELGRANO',	2136,-27.47333, -58.82409),
('BELGRANO',	2300,-27.47358, -58.82157),
('BOLIVAR',	200,-27.46986, -58.84820),
('BOLIVAR',	300,-27.46998, -58.84697),
('BOLIVAR',	519,-27.47021, -58.84439),
('BOLIVAR',	797,-27.47054, -58.84076),
('BOLIVAR',	962,-27.47073, -58.83882),
('BOLIVAR',	1119,-27.47088, -58.83709),
('BOLIVAR',	1339,-27.47116, -58.83407),
('BOLIVAR',	1502,-27.47136, -58.83214),
('BOLIVAR',	1762,-27.47171, -58.82886),
('BOLIVAR',	1945,-27.47196, -58.82627),
('BOLIVAR',	2162,-27.47218, -58.82382),
('BOLIVAR',	2300,-27.47235, -58.82190),
('BRASIL',	957,-27.46929, -58.82414),
('BRASIL',	1132,-27.47157, -58.82442),
('BRASIL',	1229,-27.47271, -58.82456),
('BRASIL',	1600,-27.47690, -58.82503),
('BUENOS AIRES',	400,-27.46236, -58.84003),
('BUENOS AIRES',	524,-27.46328, -58.84016),
('BUENOS AIRES',	724,-27.46548, -58.84039),
('BUENOS AIRES',	949,-27.46781, -58.84055),
('BUENOS AIRES',	1134,-27.47054, -58.84076),
('BUENOS AIRES',	1339,-27.47232, -58.84094),
('BUENOS AIRES',	1501,-27.47396, -58.84111),
('C. HEROES CIVILES',	1600,-27.47561, -58.83909),
('C. HEROES CIVILES',	1898,-27.47913, -58.83952),
('C. IRALA',	2400,-27.48486, -58.84303),
('C. J. M. AGUIRRE',	6380,-27.52770, -58.79053),
('C. LAS PIEDRAS',	1832,-27.48308, -58.80070),
('C. NICARAGUA',	3100,-27.49884, -58.81406),
('CAA GUAZU',	341,-27.46184, -58.83061),
('CARIBE',	3100,-27.49900, -58.81541),
('CARLOS PELLEGRINI',	400,-27.46461, -58.84526),
('CARLOS PELLEGRINI',	539,-27.46473, -58.84356),
('CARLOS PELLEGRINI',	724,-27.46494, -58.84088),
('CARLOS PELLEGRINI',	945,-27.46516, -58.83842),
('CARLOS PELLEGRINI',	1116,-27.46536, -58.83653),
('CARLOS PELLEGRINI',	1348,-27.46562, -58.83343),
('CARLOS PELLEGRINI',	1493,-27.46579, -58.83154),
('CARLOS PELLEGRINI',	1750,-27.46609, -58.82829),
('CARLOS PELLEGRINI',	1885,-27.46627, -58.82640),
('CARLOS PELLEGRINI',	2108,-27.46648, -58.82380),
('CATAMARCA',	352,-27.46176, -58.83236),
('CATAMARCA',	524,-27.46366, -58.83258),
('CATAMARCA',	709,-27.46567, -58.83283),
('CATAMARCA',	943,-27.46847, -58.83315),
('CATAMARCA',	1126,-27.47075, -58.83340),
('CATAMARCA',	1306,-27.47237, -58.83358),
('CATAMARCA',	1518,-27.47525, -58.83387),
('CHACO',	600,-27.46487, -58.84656),
('CHACO',	1166,-27.46952, -58.84695),
('CHACO',	1289,-27.47123, -58.84711),
('CHACO',	1500,-27.47374, -58.84734),
('CNEL. BAIBIENE',	1996,-27.46314, -58.82175),
('COCOMAROLA',	750,-27.46745, -58.81840),
('CORDOBA',	334,-27.46175, -58.83371),
('CORDOBA',	509,-27.46327, -58.83383),
('CORDOBA',	772,-27.46610, -58.83418),
('CORDOBA',	907,-27.46782, -58.83438),
('CORDOBA',	1098,-27.47001, -58.83467),
('CORDOBA',	1312,-27.47255, -58.83498),
('CORDOBA',	1480,-27.47455, -58.83522),
('COSQUIN',	1500,-27.49338, -58.83456),
('COSQUIN',	1700,-27.49360, -58.83281),
('COSQUIN',	2100,-27.49446, -58.82672),
('CUBA',	5100,-27.50480, -58.79304),
('DON BOSCO',	1100,-27.46888, -58.84945),
('DON BOSCO',	1325,-27.47159, -58.84972),
('DORREGO',	600,-27.47266, -58.79822),
('DR. R. CARRILLO',	533,-27.47533, -58.84504),
('DR. W DOMINGUEZ',	2500,-27.50369, -58.82433),
('ENTRE RIOS',	900,-27.46700, -58.84420),
('ENTRE RIOS',	1130,-27.46962, -58.84438),
('ENTRE RIOS',	1500,-27.47366, -58.84475),
('ESPAÑA',	350,-27.46238, -58.82863),
('ESPAÑA',	540,-27.46454, -58.82879),
('ESPAÑA',	740,-27.46651, -58.82904),
('ESPAÑA',	947,-27.46877, -58.82932),
('ESPAÑA',	1158,-27.47108, -58.82959),
('ESPAÑA',	1337,-27.47332, -58.82980),
('ESPAÑA',	1495,-27.47501, -58.82999),
('EX VIAS GRAL. URQUIZA',	1800,-27.47935, -58.82755),
('FRAY JOSE DE LA QUINTANA',	600,-27.46253, -58.84266),
('FRAY JOSE DE LA QUINTANA',	701,-27.46264, -58.84132),
('FRAY JOSE DE LA QUINTANA',	974,-27.46293, -58.83790),
('FRAY JOSE DE LA QUINTANA',	1113,-27.46308, -58.83628),
('FRAY JOSE DE LA QUINTANA',	1338,-27.46334, -58.83317),
('FRAY JOSE DE LA QUINTANA',	1522,-27.46357, -58.83061),
('FRAY JOSE DE LA QUINTANA',	1743,-27.46372, -58.82811),
('FRAY JOSE DE LA QUINTANA',	1820,-27.46397, -58.82609),
('GDOR. CASTILLO',	1800,-27.47759, -58.84204),
('GDOR. GALLINO',	170,-27.46056, -58.82050),
('GDOR. GONZALEZ',	1600,-27.47727, -58.82632),
('GODOY CRUZ',	1300,-27.47896, -58.78906),
('GRAL. PAZ',	1200,-27.47832, -58.83669),
('GRAL. PAZ',	1757,-27.47894, -58.83108),
('GRAL. PAZ',	2200,-27.47970, -58.82396),
('GREGORIO POMAR',	950,-27.47014, -58.80555),
('GUEMES',	1000,-27.47283, -58.80634),
('GUTEMBERG',	1600,-27.47673, -58.83147),
('H. YRIGOYEN',	150,-27.46778, -58.84867),
('H. YRIGOYEN',	300,-27.46795, -58.84680),
('H. YRIGOYEN',	573,-27.46808, -58.84371),
('H. YRIGOYEN',	729,-27.46820, -58.84115),
('H. YRIGOYEN',	926,-27.46843, -58.83869),
('H. YRIGOYEN',	1155,-27.46872, -58.83628),
('H. YRIGOYEN',	1321,-27.46892, -58.83386),
('H. YRIGOYEN',	1579,-27.46919, -58.83126),
('H. YRIGOYEN',	1670,-27.46935, -58.82953),
('H. YRIGOYEN',	1920,-27.46967, -58.82611),
('H. YRIGOYEN',	2136,-27.46991, -58.82353),
('H. YRIGOYEN',	2316,-27.47017, -58.82098),
('H. YRIGOYEN',	2417,-27.47034, -58.81952),
('IGARZABAL',	4000,-27.50219, -58.83127),
('ITUZAINGO',	928,-27.47001, -58.81896),
('J. M. ROLON',	2200,-27.46157, -58.82172),
('JOSE RAMON VIDAL',	1800,-27.47807, -58.83814),
('JUAN JOSE PASO',	3081,-27.49348, -58.81366),
('JUJUY',	400,-27.46287, -58.82731),
('JUJUY',	534,-27.46450, -58.82749),
('JUJUY',	748,-27.46664, -58.82776),
('JUJUY',	920,-27.46888, -58.82798),
('JUJUY',	1118,-27.47066, -58.82820),
('JUJUY',	1330,-27.47352, -58.82848),
('JUJUY',	1454,-27.47458, -58.82856),
('JUNIN',	166,-27.46665, -58.84865),
('JUNIN',	530,-27.46704, -58.84356),
('JUNIN',	788,-27.46725, -58.84107),
('JUNIN',	874,-27.46733, -58.83917),
('JUNIN',	1200,-27.46772, -58.83558),
('JUNIN',	1273,-27.46782, -58.83438),
('JUNIN',	1594,-27.46819, -58.83051),
('JUNIN',	1637,-27.46825, -58.82979),
('JUNIN',	1898,-27.46852, -58.82661),
('JUNIN',	2199,-27.46887, -58.82276),
('LA RIOJA',	400,-27.46193, -58.83752),
('LA RIOJA',	512,-27.46355, -58.83770),
('LA RIOJA',	742,-27.46586, -58.83792),
('LA RIOJA',	935,-27.46800, -58.83815),
('LA RIOJA',	1100,-27.46965, -58.83830),
('LA RIOJA',	1280,-27.47193, -58.83853),
('LA RIOJA',	1449,-27.47363, -58.83872),
('LAMADRID',	600,-27.48070, -58.84511),
('LAPACHO',	700,-27.46894, -58.79876),
('LAPLACE',	5000,-27.47365, -58.78942),
('LARREA',	4200,-27.49117, -58.80261),
('LARRETA',	500,-27.52428, -58.79207),
('LAS HERAS',	1000,-27.48026, -58.83970),
('LAS MARGARITAS',	5700,-27.46233, -58.77670),
('LAS VIOLETAS',	200,-27.45835, -58.77628),
('LAS VIOLETAS',	500,-27.45543, -58.77738),
('LAVALLE',	132,-27.47528, -58.85025),
('LAVALLE',	552,-27.47599, -58.84513),
('LAVALLE',	934,-27.47668, -58.83989),
('LAVALLE',	1030,-27.47693, -58.83798),
('LAVALLE',	1700,-27.47752, -58.82999),
('LAVALLE',	1820,-27.47785, -58.82824),
('LAVALLE',	3000,-27.47915, -58.81488),
('LAVALLE',	3800,-27.48162, -58.80545),
('LAVALLE',	4300,-27.48313, -58.79909),
('LEOPOLDO LUGONES',	600,-27.46797, -58.79898),
('LOS GIRASOLES',	5700,-27.45540, -58.77738),
('LUIS BRAILLE',	3691,-27.47827, -58.80644),
('MADARIAGA',	1209,-27.48299, -58.83743),
('MARIANO MORENO',	150,-27.47220, -58.84943),
('MARIANO MORENO',	800,-27.47288, -58.84097),
('MARIANO MORENO',	895,-27.47300, -58.83950),
('MARIANO MORENO',	1148,-27.47322, -58.83677),
('MARIANO MORENO',	1334,-27.47343, -58.83439),
('MARIANO MORENO',	1515,-27.47363, -58.83242),
('MARIANO MORENO',	1668,-27.47380, -58.83049),
('MARIANO MORENO',	2100,-27.47439, -58.82460),
('MARIANO MORENO',	2400,-27.47479, -58.82091),
('MEDRANO',	1271,-27.47822, -58.79776),
('MEDRANO',	1600,-27.48177, -58.79840),
('MEDRANO',	1700,-27.48320, -58.79868),
('MEDRANO',	2000,-27.48542, -58.79905),
('MEDRANO',	2200,-27.48702, -58.79935),
('MEDRANO',	2273,-27.49000, -58.79975),
('MEDRANO',	2500,-27.49305, -58.79942),
('MEDRANO',	2700,-27.49481, -58.79990),
('MENDOZA',	382,-27.46172, -58.83496),
('MENDOZA',	548,-27.46370, -58.83522),
('MENDOZA',	760,-27.46597, -58.83541),
('MENDOZA',	981,-27.46816, -58.83565),
('MENDOZA',	1052,-27.46939, -58.83577),
('MENDOZA',	1336,-27.47267, -58.83616),
('MENDOZA',	1490,-27.47444, -58.83631),
('MISIONES',	1000,-27.46803, -58.84556),
('MISIONES',	1086,-27.46913, -58.84565),
('MISIONES',	1423,-27.47297, -58.84600),
('NECOCHEA',	100,-27.47733, -58.85185),
('NECOCHEA',	300,-27.47790, -58.84867),
('NECOCHEA',	800,-27.47873, -58.84218),
('NECOCHEA',	999,-27.47916, -58.83953),
('NECOCHEA',	1097,-27.47933, -58.83833),
('NECOCHEA',	1205,-27.47942, -58.83707),
('NECOCHEA',	1600,-27.48007, -58.83186),
('NECOCHEA',	2200,-27.48117, -58.82411),
('NECOCHEA',	3500,-27.48288, -58.80932),
('NUESTRA SEÑORA DE LA ASUNCION',	2000,-27.49219, -58.82229),
('NUESTRA SEÑORA DE LA ASUNCION',	2235,-27.49145, -58.82051),
('NUESTRA SEÑORA DE LA ASUNCION',	2600,-27.48913, -58.81693),
('ÑAEMBE',	3000,-27.47961, -58.81533),
('P. NIVEIRO',	1680,-27.47558, -58.84575),
('PAGO LARGO',	1200,-27.46984, -58.84822),
('PAGO LARGO',	1633,-27.47457, -58.84957),
('PARAGUAY',	350,-27.46217, -58.82595),
('PARAGUAY',	500,-27.46397, -58.82603),
('PARAGUAY',	776,-27.46671, -58.82645),
('PARAGUAY',	865,-27.46797, -58.82655),
('PARAGUAY',	1096,-27.47076, -58.82686),
('PERU',	1000,-27.47011, -58.82170),
('PJE. AGUSTIN GONZALEZ',	1000,-27.46701, -58.83740),
('PJE. CABRAL',	2050,-27.47953, -58.84959),
('PJE. FARIÑA',	2100,-27.47787, -58.82466),
('PJE. TORRENT',	950,-27.46981, -58.81946),
('PLACIDO MARTINEZ',	793,-27.46170, -58.83898),
('PLACIDO MARTINEZ',	957,-27.46187, -58.83708),
('PLACIDO MARTINEZ',	1133,-27.46205, -58.83554),
('PLACIDO MARTINEZ',	1282,-27.46230, -58.83373),
('PLACIDO MARTINEZ',	1486,-27.46258, -58.83119),
('PLACIDO MARTINEZ',	1750,-27.46287, -58.82798),
('RAFAELA',	2100,-27.49735, -58.82622),
('RECONQUISTA',	3277,-27.49638, -58.81579),
('REMEDIOS DE ESCALADA',	5001,-27.46366, -58.78790),
('RENACIMIENTO',	506,-27.50984, -58.79436),
('REPUBLICA DEL LIBANO',	200,-27.48027, -58.82999),
('RIVADAVIA',	492,-27.47366, -58.84474),
('RIVADAVIA',	712,-27.47388, -58.84206),
('RIVADAVIA',	977,-27.47414, -58.83924),
('RIVADAVIA',	1161,-27.47437, -58.83684),
('RIVADAVIA',	1358,-27.47461, -58.83447),
('RIVADAVIA',	1514,-27.47483, -58.83186),
('RIVADAVIA',	1701,-27.47502, -58.83000),
('RIVADAVIA',	1883,-27.47530, -58.82735),
('ROCA',	800,-27.46748, -58.82247),
('ROCA',	945,-27.46937, -58.82285),
('ROCA',	1088,-27.47112, -58.82314),
('ROCA',	1266,-27.47288, -58.82329),
('RUTA 12',	1030,-27.44785, -58.75011),
('RUTA 5',	5,-27.48805, -58.76360),
('SAAVEDRA',	1492,-27.47721, -58.81195),
('SALTA',	400,-27.46217, -58.83885),
('SALTA',	434,-27.46217, -58.83885),
('SALTA',	770,-27.46572, -58.83907),
('SALTA',	889,-27.46733, -58.83917),
('SALTA',	1179,-27.47069, -58.83938),
('SALTA',	1310,-27.47183, -58.83945),
('SALTA',	1484,-27.47414, -58.83961),
('SAN JUAN',	544,-27.46369, -58.83642),
('SAN JUAN',	795,-27.46644, -58.83665),
('SAN JUAN',	920,-27.46811, -58.83681),
('SAN JUAN',	1107,-27.46981, -58.83694),
('SAN JUAN',	1294,-27.47204, -58.83722),
('SAN JUAN',	1461,-27.47371, -58.83738),
('SAN LORENZO',	360,-27.46192, -58.83112),
('SAN LORENZO',	516,-27.46352, -58.83128),
('SAN LORENZO',	791,-27.46686, -58.83164),
('SAN LORENZO',	902,-27.46807, -58.83181),
('SAN LORENZO',	1116,-27.47027, -58.83205),
('SAN LORENZO',	1332,-27.47305, -58.83235),
('SAN LORENZO',	1461,-27.47454, -58.83254),
('SAN LUIS',	720,-27.46504, -58.84280),
('SAN LUIS',	978,-27.46757, -58.84299),
('SAN LUIS',	1106,-27.46921, -58.84310),
('SAN LUIS',	1300,-27.47151, -58.84330),
('SAN LUIS',	1517,-27.47380, -58.84350),
('SAN MARTIN',	129,-27.46890, -58.84883),
('SAN MARTIN',	387,-27.46908, -58.84628),
('SAN MARTIN',	524,-27.46936, -58.84436),
('SAN MARTIN',	768,-27.46937, -58.84125),
('SAN MARTIN',	970,-27.46958, -58.83882),
('SAN MARTIN',	1097,-27.46981, -58.83693),
('SAN MARTIN',	1369,-27.47006, -58.83392),
('SAN MARTIN',	1558,-27.47033, -58.83140),
('SAN MARTIN',	1664,-27.47046, -58.83010),
('SAN MARTIN',	1899,-27.47074, -58.82689),
('SAN MARTIN',	2096,-27.47100, -58.82440),
('SAN MARTIN',	2250,-27.47117, -58.82252),
('SAN MARTIN',	2413,-27.47149, -58.81985),
('SANCHEZ DE BUSTAMANTE',	1200,-27.47881, -58.78831),
('SANCHEZ DE BUSTAMANTE',	1900,-27.48759, -58.78939),
('SANCHEZ DE BUSTAMANTE',	2200,-27.49020, -58.78981),
('SANCHEZ DE BUSTAMANTE',	4008,-27.50884, -58.79155),
('SANTA FE',	332,-27.46205, -58.82985),
('SANTA FE',	557,-27.46422, -58.83004),
('SANTA FE',	774,-27.46639, -58.83031),
('SANTA FE',	907,-27.46819, -58.83051),
('SANTA FE',	1128,-27.47088, -58.83082),
('SANTA FE',	1330,-27.47317, -58.83108),
('SANTA FE',	1485,-27.47480, -58.83124),
('STA. ROSA',	1700,-27.47853, -58.81990),
('TACUARI',	1100,-27.47398, -58.80547),
('TACUARI',	2200,-27.48638, -58.80727),
('TILCARA',	3400,-27.50251, -58.80910),
('TUCUMAN',	400,-27.46159, -58.84123),
('TUCUMAN',	514,-27.46267, -58.84133),
('TUCUMAN',	725,-27.46518, -58.84151),
('TUCUMAN',	922,-27.46746, -58.84166),
('TUCUMAN',	1156,-27.46986, -58.84184),
('TUCUMAN',	1313,-27.47185, -58.84199),
('TUCUMAN',	1504,-27.47389, -58.84215),
('TURIN',	2800,-27.48798, -58.78360),
('UNNE',	450,-27.46297, -58.78460),
('URUGUAY',	399,-27.46233, -58.82468),
('URUGUAY',	580,-27.46512, -58.82489),
('URUGUAY',	777,-27.46690, -58.82513),
('URUGUAY',	912,-27.46861, -58.82535),
('URUGUAY',	1105,-27.47088, -58.82559),
('URUGUAY',	1600,-27.47659, -58.82630),
('VELEZ SARSFIELD',	717,-27.46722, -58.81999),
('VELEZ SARSFIELD',	900,-27.46912, -58.82021),
('VIEDMA',	1200,-27.48764, -58.83220),
('ZARATE',	2486,-27.48493, -58.84504);

--CARGA DE DATOS LATITUD Y LONGITUD A TABLA ACTAS_INFRACCION

ALTER TABLE ACTAS_INFRACCION ADD LATITUD DECIMAL(10,5);
ALTER TABLE ACTAS_INFRACCION ADD LONGITUD DECIMAL(10,5);

UPDATE ACTAS_INFRACCION
SET ACTAS_INFRACCION.LATITUD = UBICACION.LATITUD
FROM ACTAS_INFRACCION
INNER JOIN UBICACION ON ACTAS_INFRACCION.CALLE = UBICACION.CALLE;

UPDATE ACTAS_INFRACCION
SET ACTAS_INFRACCION.LONGITUD = UBICACION.LONGITUD
FROM ACTAS_INFRACCION
INNER JOIN UBICACION ON ACTAS_INFRACCION.CALLE = UBICACION.CALLE;

--CREACION DE TABLAS FINALES

CREATE TABLE TIPO_VEHICULO (
	ID_TIPO_VEHICULO INT NOT NULL PRIMARY KEY IDENTITY(1,1),
	TIPO_VEHICULO VARCHAR(100)
);

INSERT INTO TIPO_VEHICULO (TIPO_VEHICULO)
SELECT DISTINCT TIPO_VEHICULO
FROM ACTAS_INFRACCION;

ALTER TABLE ACTAS_INFRACCION ADD ID_TIPO_VEHICULO VARCHAR(100);

UPDATE ACTAS_INFRACCION
SET ACTAS_INFRACCION.ID_TIPO_VEHICULO = TIPO_VEHICULO.ID_TIPO_VEHICULO
FROM ACTAS_INFRACCION
INNER JOIN TIPO_VEHICULO ON ACTAS_INFRACCION.TIPO_VEHICULO = TIPO_VEHICULO.TIPO_VEHICULO;

CREATE TABLE ACTAS (
	ID_ACTA INT NOT NULL PRIMARY KEY IDENTITY(1,1),
	FECHA DATE,
	ID_CALLE INT,
	ALTURA INT,
	ID_TIPO_VEHICULO INT,
	LATITUD DECIMAL(10,5),
	LONGITUD DECIMAL(10,5)
);

INSERT INTO ACTAS (FECHA, ID_CALLE, ALTURA, ID_TIPO_VEHICULO, LATITUD, LONGITUD)
SELECT FECHA, ID_CALLE, ALTURA_PROMEDIO, ID_TIPO_VEHICULO, LATITUD, LONGITUD
FROM ACTAS_INFRACCION
ORDER BY ID_ACTA;


SELECT * FROM ACTAS;
